{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@fof/upload/./node_modules/@babel/runtime/helpers/regeneratorRuntime.js","webpack://@fof/upload/./node_modules/@babel/runtime/helpers/typeof.js","webpack://@fof/upload/./node_modules/@babel/runtime/regenerator/index.js","webpack://@fof/upload/webpack/bootstrap","webpack://@fof/upload/webpack/runtime/compat get default export","webpack://@fof/upload/webpack/runtime/define property getters","webpack://@fof/upload/webpack/runtime/hasOwnProperty shorthand","webpack://@fof/upload/webpack/runtime/make namespace object","webpack://@fof/upload/external root \"flarum.core.compat['forum/app']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/models/User']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/Model']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/extend']\"","webpack://@fof/upload/external root \"flarum.core.compat['forum/components/Post']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/components/TextEditor']\"","webpack://@fof/upload/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@fof/upload/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/upload/external root \"flarum.core.compat['common/Component']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/components/TextEditorButton']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/utils/classList']\"","webpack://@fof/upload/./src/forum/components/UploadButton.js","webpack://@fof/upload/./src/forum/components/DragAndDrop.js","webpack://@fof/upload/./src/forum/components/PasteClipboard.js","webpack://@fof/upload/./src/forum/handler/Uploader.js","webpack://@fof/upload/external root \"flarum.core.compat['common/components/Button']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/app']\"","webpack://@fof/upload/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://@fof/upload/./src/common/mimeToIcon.ts","webpack://@fof/upload/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/components/Tooltip']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@fof/upload/./src/common/components/DisplayFile.tsx","webpack://@fof/upload/external root \"flarum.core.compat['common/components/Alert']\"","webpack://@fof/upload/./src/common/components/AbstractFIleList.tsx","webpack://@fof/upload/./src/common/components/UserFileList.tsx","webpack://@fof/upload/external root \"flarum.core.compat['common/components/Switch']\"","webpack://@fof/upload/./src/common/components/UploadSharedFileModal.tsx","webpack://@fof/upload/./src/common/components/SharedFileList.tsx","webpack://@fof/upload/./src/common/states/FileListState.ts","webpack://@fof/upload/./src/forum/components/FileManagerModal.js","webpack://@fof/upload/./src/forum/components/FileManagerButton.tsx","webpack://@fof/upload/external root \"flarum.core.compat['forum/components/UserPage']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/extenders']\"","webpack://@fof/upload/./src/common/models/File.ts","webpack://@fof/upload/./src/common/extend.ts","webpack://@fof/upload/./src/forum/components/UploadsUserPage.tsx","webpack://@fof/upload/./src/forum/extend.ts","webpack://@fof/upload/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@fof/upload/./src/common/components/UploadedFile.tsx","webpack://@fof/upload/./src/forum/components/index.ts","webpack://@fof/upload/./src/common/components/index.ts","webpack://@fof/upload/./src/forum/index.js","webpack://@fof/upload/./src/forum/addUploadButton.js","webpack://@fof/upload/./src/forum/downloadButtonInteraction.js","webpack://@fof/upload/./src/forum/addUserPageButton.js"],"sourcesContent":["var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction _regeneratorRuntime() {\n  \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */\n  module.exports = _regeneratorRuntime = function _regeneratorRuntime() {\n    return e;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  var t,\n    e = {},\n    r = Object.prototype,\n    n = r.hasOwnProperty,\n    o = Object.defineProperty || function (t, e, r) {\n      t[e] = r.value;\n    },\n    i = \"function\" == typeof Symbol ? Symbol : {},\n    a = i.iterator || \"@@iterator\",\n    c = i.asyncIterator || \"@@asyncIterator\",\n    u = i.toStringTag || \"@@toStringTag\";\n  function define(t, e, r) {\n    return Object.defineProperty(t, e, {\n      value: r,\n      enumerable: !0,\n      configurable: !0,\n      writable: !0\n    }), t[e];\n  }\n  try {\n    define({}, \"\");\n  } catch (t) {\n    define = function define(t, e, r) {\n      return t[e] = r;\n    };\n  }\n  function wrap(t, e, r, n) {\n    var i = e && e.prototype instanceof Generator ? e : Generator,\n      a = Object.create(i.prototype),\n      c = new Context(n || []);\n    return o(a, \"_invoke\", {\n      value: makeInvokeMethod(t, r, c)\n    }), a;\n  }\n  function tryCatch(t, e, r) {\n    try {\n      return {\n        type: \"normal\",\n        arg: t.call(e, r)\n      };\n    } catch (t) {\n      return {\n        type: \"throw\",\n        arg: t\n      };\n    }\n  }\n  e.wrap = wrap;\n  var h = \"suspendedStart\",\n    l = \"suspendedYield\",\n    f = \"executing\",\n    s = \"completed\",\n    y = {};\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n  var p = {};\n  define(p, a, function () {\n    return this;\n  });\n  var d = Object.getPrototypeOf,\n    v = d && d(d(values([])));\n  v && v !== r && n.call(v, a) && (p = v);\n  var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p);\n  function defineIteratorMethods(t) {\n    [\"next\", \"throw\", \"return\"].forEach(function (e) {\n      define(t, e, function (t) {\n        return this._invoke(e, t);\n      });\n    });\n  }\n  function AsyncIterator(t, e) {\n    function invoke(r, o, i, a) {\n      var c = tryCatch(t[r], t, o);\n      if (\"throw\" !== c.type) {\n        var u = c.arg,\n          h = u.value;\n        return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) {\n          invoke(\"next\", t, i, a);\n        }, function (t) {\n          invoke(\"throw\", t, i, a);\n        }) : e.resolve(h).then(function (t) {\n          u.value = t, i(u);\n        }, function (t) {\n          return invoke(\"throw\", t, i, a);\n        });\n      }\n      a(c.arg);\n    }\n    var r;\n    o(this, \"_invoke\", {\n      value: function value(t, n) {\n        function callInvokeWithMethodAndArg() {\n          return new e(function (e, r) {\n            invoke(t, n, e, r);\n          });\n        }\n        return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();\n      }\n    });\n  }\n  function makeInvokeMethod(e, r, n) {\n    var o = h;\n    return function (i, a) {\n      if (o === f) throw Error(\"Generator is already running\");\n      if (o === s) {\n        if (\"throw\" === i) throw a;\n        return {\n          value: t,\n          done: !0\n        };\n      }\n      for (n.method = i, n.arg = a;;) {\n        var c = n.delegate;\n        if (c) {\n          var u = maybeInvokeDelegate(c, n);\n          if (u) {\n            if (u === y) continue;\n            return u;\n          }\n        }\n        if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) {\n          if (o === h) throw o = s, n.arg;\n          n.dispatchException(n.arg);\n        } else \"return\" === n.method && n.abrupt(\"return\", n.arg);\n        o = f;\n        var p = tryCatch(e, r, n);\n        if (\"normal\" === p.type) {\n          if (o = n.done ? s : l, p.arg === y) continue;\n          return {\n            value: p.arg,\n            done: n.done\n          };\n        }\n        \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg);\n      }\n    };\n  }\n  function maybeInvokeDelegate(e, r) {\n    var n = r.method,\n      o = e.iterator[n];\n    if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y;\n    var i = tryCatch(o, e.iterator, r.arg);\n    if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y;\n    var a = i.arg;\n    return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y);\n  }\n  function pushTryEntry(t) {\n    var e = {\n      tryLoc: t[0]\n    };\n    1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e);\n  }\n  function resetTryEntry(t) {\n    var e = t.completion || {};\n    e.type = \"normal\", delete e.arg, t.completion = e;\n  }\n  function Context(t) {\n    this.tryEntries = [{\n      tryLoc: \"root\"\n    }], t.forEach(pushTryEntry, this), this.reset(!0);\n  }\n  function values(e) {\n    if (e || \"\" === e) {\n      var r = e[a];\n      if (r) return r.call(e);\n      if (\"function\" == typeof e.next) return e;\n      if (!isNaN(e.length)) {\n        var o = -1,\n          i = function next() {\n            for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next;\n            return next.value = t, next.done = !0, next;\n          };\n        return i.next = i;\n      }\n    }\n    throw new TypeError(_typeof(e) + \" is not iterable\");\n  }\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", {\n    value: GeneratorFunctionPrototype,\n    configurable: !0\n  }), o(GeneratorFunctionPrototype, \"constructor\", {\n    value: GeneratorFunction,\n    configurable: !0\n  }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) {\n    var e = \"function\" == typeof t && t.constructor;\n    return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name));\n  }, e.mark = function (t) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t;\n  }, e.awrap = function (t) {\n    return {\n      __await: t\n    };\n  }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () {\n    return this;\n  }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) {\n    void 0 === i && (i = Promise);\n    var a = new AsyncIterator(wrap(t, r, n, o), i);\n    return e.isGeneratorFunction(r) ? a : a.next().then(function (t) {\n      return t.done ? t.value : a.next();\n    });\n  }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () {\n    return this;\n  }), define(g, \"toString\", function () {\n    return \"[object Generator]\";\n  }), e.keys = function (t) {\n    var e = Object(t),\n      r = [];\n    for (var n in e) r.push(n);\n    return r.reverse(), function next() {\n      for (; r.length;) {\n        var t = r.pop();\n        if (t in e) return next.value = t, next.done = !1, next;\n      }\n      return next.done = !0, next;\n    };\n  }, e.values = values, Context.prototype = {\n    constructor: Context,\n    reset: function reset(e) {\n      if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t);\n    },\n    stop: function stop() {\n      this.done = !0;\n      var t = this.tryEntries[0].completion;\n      if (\"throw\" === t.type) throw t.arg;\n      return this.rval;\n    },\n    dispatchException: function dispatchException(e) {\n      if (this.done) throw e;\n      var r = this;\n      function handle(n, o) {\n        return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o;\n      }\n      for (var o = this.tryEntries.length - 1; o >= 0; --o) {\n        var i = this.tryEntries[o],\n          a = i.completion;\n        if (\"root\" === i.tryLoc) return handle(\"end\");\n        if (i.tryLoc <= this.prev) {\n          var c = n.call(i, \"catchLoc\"),\n            u = n.call(i, \"finallyLoc\");\n          if (c && u) {\n            if (this.prev < i.catchLoc) return handle(i.catchLoc, !0);\n            if (this.prev < i.finallyLoc) return handle(i.finallyLoc);\n          } else if (c) {\n            if (this.prev < i.catchLoc) return handle(i.catchLoc, !0);\n          } else {\n            if (!u) throw Error(\"try statement without catch or finally\");\n            if (this.prev < i.finallyLoc) return handle(i.finallyLoc);\n          }\n        }\n      }\n    },\n    abrupt: function abrupt(t, e) {\n      for (var r = this.tryEntries.length - 1; r >= 0; --r) {\n        var o = this.tryEntries[r];\n        if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) {\n          var i = o;\n          break;\n        }\n      }\n      i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null);\n      var a = i ? i.completion : {};\n      return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a);\n    },\n    complete: function complete(t, e) {\n      if (\"throw\" === t.type) throw t.arg;\n      return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y;\n    },\n    finish: function finish(t) {\n      for (var e = this.tryEntries.length - 1; e >= 0; --e) {\n        var r = this.tryEntries[e];\n        if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y;\n      }\n    },\n    \"catch\": function _catch(t) {\n      for (var e = this.tryEntries.length - 1; e >= 0; --e) {\n        var r = this.tryEntries[e];\n        if (r.tryLoc === t) {\n          var n = r.completion;\n          if (\"throw\" === n.type) {\n            var o = n.arg;\n            resetTryEntry(r);\n          }\n          return o;\n        }\n      }\n      throw Error(\"illegal catch attempt\");\n    },\n    delegateYield: function delegateYield(e, r, n) {\n      return this.delegate = {\n        iterator: values(e),\n        resultName: r,\n        nextLoc: n\n      }, \"next\" === this.method && (this.arg = t), y;\n    }\n  }, e;\n}\nmodule.exports = _regeneratorRuntime, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _typeof(o);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// TODO(Babel 8): Remove this file.\n\nvar runtime = require(\"../helpers/regeneratorRuntime\")();\nmodule.exports = runtime;\n\n// Copied from https://github.com/facebook/regenerator/blob/main/packages/runtime/runtime.js#L736=\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/User'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/Post'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/TextEditor'];","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/TextEditorButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/classList'];","import app from 'flarum/forum/app';\nimport Component from 'flarum/common/Component';\nimport TextEditorButton from 'flarum/common/components/TextEditorButton';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport classList from 'flarum/common/utils/classList';\n\nexport default class UploadButton extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.attrs.uploader.on('uploaded', () => {\n      // reset the button for a new upload\n      this.$('form')[0].reset();\n\n      // redraw to reflect uploader.loading in the DOM\n      m.redraw();\n    });\n\n    this.isMediaUploadButton = vnode.attrs.isMediaUploadButton || false;\n  }\n\n  view() {\n    const buttonText = this.attrs.uploader.uploading\n      ? app.translator.trans('fof-upload.forum.states.loading')\n      : app.translator.trans('fof-upload.forum.buttons.upload');\n\n    return (\n      <TextEditorButton\n        className={classList([\n          'Button',\n          'hasIcon',\n          'fof-upload-button',\n          !this.isMediaUploadButton && !this.attrs.uploader.uploading && 'Button--icon',\n          !this.isMediaUploadButton && !this.attrs.uploader.uploading && 'Button--link',\n          this.attrs.uploader.uploading && 'uploading',\n        ])}\n        icon={!this.attrs.uploader.uploading && 'fas fa-file-upload'}\n        onclick={this.uploadButtonClicked.bind(this)}\n        disabled={this.attrs.disabled}\n        title={buttonText}\n      >\n        {this.attrs.uploader.uploading && <LoadingIndicator size=\"small\" display=\"inline\" className=\"Button-icon\" />}\n        {(this.isMediaUploadButton || this.attrs.uploader.uploading) && <span className=\"Button-label\">{buttonText}</span>}\n        <form>\n          <input type=\"file\" multiple={true} onchange={this.process.bind(this)} />\n        </form>\n      </TextEditorButton>\n    );\n  }\n\n  /**\n   * Process the upload event.\n   *\n   * @param e\n   */\n  process(e) {\n    // get the file from the input field\n    const files = this.$('input').prop('files');\n\n    if (files.length === 0) {\n      // We've got no files to upload, so trying\n      // to begin an upload will show an error\n      // to the user.\n      return;\n    }\n\n    this.attrs.uploader.upload(files, !this.isMediaUploadButton);\n  }\n\n  /**\n   * Event handler for upload button being clicked\n   *\n   * @param {PointerEvent} e\n   */\n  uploadButtonClicked(e) {\n    // Trigger click on hidden input element\n    // (Opens file dialog)\n    this.$('input').click();\n  }\n}\n","export default class DragAndDrop {\n  constructor(upload, composerElement) {\n    this.upload = upload;\n    this.composerElement = composerElement;\n\n    // Keep references to the bound methods so we can remove the event listeners later\n    this.handlers = {};\n\n    if (!this.supportsFileDragging()) {\n      return;\n    }\n\n    this.composerElement.addEventListener('dragover', (this.handlers.in = this.in.bind(this)));\n\n    this.composerElement.addEventListener('dragleave', (this.handlers.out = this.out.bind(this)));\n    this.composerElement.addEventListener('dragend', this.handlers.out);\n\n    this.composerElement.addEventListener('drop', (this.handlers.dropping = this.dropping.bind(this)));\n  }\n\n  supportsFileDragging() {\n    // Based on https://css-tricks.com/drag-and-drop-file-uploading/\n    const div = document.createElement('div');\n\n    return ('draggable' in div || ('ondragstart' in div && 'ondrop' in div)) && 'FormData' in window && 'FileReader' in window;\n  }\n\n  unload() {\n    // If the handlers were not set (drag and drop not supported), we skip removing them\n    if (!this.handlers.in) {\n      return;\n    }\n\n    this.composerElement.removeEventListener('dragover', this.handlers.in);\n\n    this.composerElement.removeEventListener('dragleave', this.handlers.out);\n    this.composerElement.removeEventListener('dragend', this.handlers.out);\n\n    this.composerElement.removeEventListener('drop', this.handlers.dropping);\n  }\n\n  isNotFile(event) {\n    // Checking event.dataTransfer.files.length does not work on dragover event, it's always zero\n    // So we use the dataTransfer.items property to check whether any file is being dragged\n    if (event.dataTransfer.items) {\n      for (let i = 0; i < event.dataTransfer.items.length; i++) {\n        if (event.dataTransfer.items[i].kind !== 'file') {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  in(event) {\n    if (this.isNotFile(event)) {\n      return;\n    }\n\n    event.preventDefault();\n\n    if (!this.over) {\n      this.composerElement.classList.add('fof-upload-dragging');\n      this.over = true;\n    }\n  }\n\n  out(event) {\n    if (this.isNotFile(event)) {\n      return;\n    }\n\n    event.preventDefault();\n\n    if (this.over) {\n      this.composerElement.classList.remove('fof-upload-dragging');\n      this.over = false;\n    }\n  }\n\n  dropping(event) {\n    if (this.isNotFile(event)) {\n      return;\n    }\n\n    event.preventDefault();\n\n    this.upload(event.dataTransfer.files);\n\n    this.composerElement.classList.remove('fof-upload-dragging');\n  }\n}\n","export default class PasteClipboard {\n  constructor(upload, element) {\n    this.upload = upload;\n\n    // We don't need to remove the events listeners, because they'll get removed when the DOM does.\n    element.addEventListener('paste', this.paste.bind(this));\n  }\n\n  paste(e) {\n    if (e.clipboardData && e.clipboardData.items) {\n      const items = e.clipboardData.items;\n\n      const files = [];\n\n      for (let i = 0; i < items.length; i++) {\n        if (items[i].type.indexOf('image') !== -1) {\n          files.push(items[i].getAsFile());\n        }\n      }\n\n      if (files.length > 0) {\n        e.preventDefault();\n\n        this.upload(files);\n      }\n    }\n  }\n}\n","import app from 'flarum/forum/app';\n\nexport default class Uploader {\n  constructor() {\n    this.callbacks = {\n      success: [],\n      failure: [],\n      uploading: [],\n      uploaded: [],\n    };\n    this.uploading = false;\n  }\n\n  setState(fileState) {\n    this.fileState = fileState;\n  }\n\n  on(type, callback) {\n    this.callbacks[type].push(callback);\n  }\n\n  dispatch(type, response) {\n    this.callbacks[type].forEach((callback) => callback(response));\n  }\n\n  upload(files, addBBcode = true) {\n    this.uploading = true;\n    this.dispatch('uploading', files);\n\n    m.redraw(); // Forcing a redraw so that the button also updates if uploadFiles() is called from DragAndDrop or PasteClipboard\n\n    const body = new FormData();\n\n    for (let i = 0; i < files.length; i++) {\n      body.append('files[]', files[i]);\n    }\n\n    // send a POST request to the api\n    return app\n      .request({\n        method: 'POST',\n        url: app.forum.attribute('apiUrl') + '/fof/upload',\n        // prevent JSON.stringify'ing the form data in the XHR call\n        serialize: (raw) => raw,\n        body,\n      })\n      .then((result) => this.uploaded(result, addBBcode))\n      .catch((error) => {\n        this.uploading = false;\n        m.redraw();\n\n        const e = error.response.errors[0];\n\n        if (!e.code.includes('fof-upload')) {\n          throw error;\n        }\n\n        app.alerts.clear();\n        app.alerts.show(\n          {\n            type: 'error',\n          },\n          e.detail\n        );\n      });\n  }\n\n  uploaded(result, addBBcode = false) {\n    this.uploading = false;\n\n    result.data.forEach((file) => {\n      const fileObj = app.store.pushObject(file);\n\n      // Add file to media manager\n      this.fileState?.addToList(fileObj);\n\n      // Dispatch\n      this.dispatch('success', {\n        file: fileObj,\n        addBBcode,\n      });\n    });\n\n    this.dispatch('uploaded');\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/app'];","function asyncGeneratorStep(n, t, e, r, o, a, c) {\n  try {\n    var i = n[a](c),\n      u = i.value;\n  } catch (n) {\n    return void e(n);\n  }\n  i.done ? t(u) : Promise.resolve(u).then(r, o);\n}\nfunction _asyncToGenerator(n) {\n  return function () {\n    var t = this,\n      e = arguments;\n    return new Promise(function (r, o) {\n      var a = n.apply(t, e);\n      function _next(n) {\n        asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n);\n      }\n      function _throw(n) {\n        asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n);\n      }\n      _next(void 0);\n    });\n  };\n}\nexport { _asyncToGenerator as default };","const mimeToIconMap = new Map<string, string>([\n  // Image formats\n  ['image/png', 'far fa-file-image'],\n  ['image/jpg', 'far fa-file-image'],\n  ['image/jpeg', 'far fa-file-image'],\n  ['image/svg+xml', 'far fa-file-image'],\n  ['image/gif', 'far fa-file-image'],\n  ['image/bmp', 'far fa-file-image'],\n  ['image/webp', 'far fa-file-image'],\n\n  // Compressed file formats\n  ['application/zip', 'far fa-file-archive'],\n  ['application/x-7z-compressed', 'far fa-file-archive'],\n  ['application/gzip', 'far fa-file-archive'],\n  ['application/vnd.rar', 'far fa-file-archive'],\n  ['application/x-rar-compressed', 'far fa-file-archive'],\n  ['application/x-tar', 'far fa-file-archive'],\n  ['application/x-iso9660-image', 'far fa-file-archive'],\n\n  // Text and code file formats\n  ['text/plain', 'far fa-file-alt'],\n  ['text/csv', 'far fa-file-csv'],\n  ['text/xml', 'far fa-file-code'],\n  ['text/html', 'far fa-file-code'],\n  ['text/css', 'far fa-file-code'],\n  ['text/javascript', 'far fa-file-code'],\n  ['application/json', 'far fa-file-code'],\n  ['application/ld+json', 'far fa-file-code'],\n  ['application/x-httpd-php', 'far fa-file-code'],\n  ['application/xml', 'far fa-file-code'],\n  ['text/xml', 'far fa-file-code'],\n\n  // Document formats\n  ['application/x-abiword', 'far fa-file-word'],\n  ['application/msword', 'far fa-file-word'],\n  ['application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'far fa-file-word'],\n  ['application/vnd.oasis.opendocument.text', 'far fa-file-word'],\n  ['application/vnd.ms-excel', 'far fa-file-excel'],\n  ['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'far fa-file-excel'],\n  ['application/vnd.oasis.opendocument.spreadsheet', 'far fa-file-excel'],\n  ['application/vnd.ms-powerpoint', 'far fa-file-powerpoint'],\n  ['application/vnd.openxmlformats-officedocument.presentationml.presentation', 'far fa-file-powerpoint'],\n  ['application/vnd.oasis.opendocument.presentation', 'far fa-file-powerpoint'],\n  ['application/pdf', 'far fa-file-pdf'],\n  ['application/rtf', 'far fa-file-alt'],\n\n  // eBook formats\n  ['application/epub+zip', 'far fa-book'],\n  ['application/x-mobipocket-ebook', 'far fa-book'],\n  ['application/vnd.amazon.ebook', 'far fa-book'],\n\n  // Audio formats\n  ['audio/mpeg', 'far fa-file-audio'],\n  ['audio/wav', 'far fa-file-audio'],\n  ['audio/x-wav', 'far fa-file-audio'],\n  ['audio/aac', 'far fa-file-audio'],\n  ['audio/ogg', 'far fa-file-audio'],\n  ['audio/flac', 'far fa-file-audio'],\n  ['audio/aiff', 'far fa-file-audio'],\n  ['audio/x-aiff', 'far fa-file-audio'],\n\n  // Video formats\n  ['video/x-msvideo', 'far fa-file-video'],\n  ['video/mp4', 'far fa-file-video'],\n  ['video/quicktime', 'far fa-file-video'],\n]);\n\nexport default function mimeToIcon(fileType: string): string {\n  // Directly return the icon if the fileType is in the map\n  return (\n    mimeToIconMap.get(fileType) ||\n    (function () {\n      // Check for generic types\n      if (fileType.startsWith('image/')) {\n        return 'far fa-file-image';\n      } else if (fileType.startsWith('video/')) {\n        return 'far fa-file-video';\n      } else if (fileType.startsWith('audio/')) {\n        return 'far fa-file-audio';\n      }\n\n      // Default icon\n      return 'far fa-file';\n    })()\n  );\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Tooltip'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","import app from 'flarum/common/app';\nimport Component, { ComponentAttrs } from 'flarum/common/Component';\nimport File from '../models/File';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport Button from 'flarum/common/components/Button';\nimport icon from 'flarum/common/helpers/icon';\nimport mimeToIcon from '../mimeToIcon';\nimport User from 'flarum/common/models/User';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport type Mithril from 'mithril';\nimport Tooltip from 'flarum/common/components/Tooltip';\nimport extractText from 'flarum/common/utils/extractText';\n\ninterface CustomAttrs extends ComponentAttrs {\n  file: File;\n  fileSelectable: boolean;\n  isSelected: boolean;\n  fileClassNames: string;\n  isFileHiding: boolean;\n  onHide: (file: File) => void | undefined;\n  onFileClick: (file: File) => void | undefined;\n  onDelete: (file: File) => void | undefined;\n  user: User;\n}\n\nexport default class DisplayFile extends Component<CustomAttrs> {\n  isFileHiding!: boolean;\n  imageLoaded: boolean = true;\n  file!: File;\n  fileIcon!: string;\n  isSelected!: boolean;\n  isSelectable!: boolean;\n\n  oninit(vnode: Mithril.Vnode<CustomAttrs, this>) {\n    super.oninit(vnode);\n\n    this.file = this.attrs.file;\n    this.isFileHiding = this.attrs.isFileHiding === undefined ? false : this.attrs.isFileHiding;\n    this.fileIcon = mimeToIcon(this.file.type());\n    this.isSelected = this.attrs.isSelected === undefined ? false : this.attrs.isSelected;\n    this.isSelectable = this.attrs.fileSelectable === undefined ? true : this.attrs.fileSelectable;\n  }\n\n  onbeforeupdate(vnode: Mithril.VnodeDOM<CustomAttrs, this>): void {\n    super.onbeforeupdate(vnode);\n\n    // Make sure the isSelected property is updated\n    this.isSelected = this.attrs.isSelected === undefined ? false : this.attrs.isSelected;\n  }\n\n  view() {\n    const isImage = this.file.type().startsWith('image/');\n\n    const fileSelectedClass = this.isSelected ? 'selected' : '';\n\n    return (\n      <div\n        className={`UploadedFile ${fileSelectedClass}`}\n        key={this.file.uuid()}\n        onclick={() => {\n          if (this.isSelectable && !this.isFileHiding) {\n            this.isSelected = !this.isSelected;\n            this.attrs.onFileClick(this.file);\n          }\n        }}\n        disabled={!this.isSelectable || this.isFileHiding}\n      >\n        {this.imageLoaded && isImage ? (\n          <img\n            src={this.file.url()}\n            className=\"fof-file-image-preview\"\n            draggable={false}\n            onerror={this.handleImageError}\n            onload={this.handleImageLoad}\n            alt={this.file.baseName()}\n          />\n        ) : (\n          this.displayIcon(this.fileIcon)\n        )}\n\n        <div className=\"fof-file-actions\">{this.actionItems(this.file).toArray()}</div>\n\n        <div className=\"fof-file-name\">\n          <Tooltip text={this.file.baseName()}>\n            <span>{this.file.baseName()}</span>\n          </Tooltip>\n        </div>\n\n        {this.isFileHiding && (\n          <div class=\"fof-file-loading\" role=\"status\" aria-label={app.translator.trans('fof-upload.lib.file_list.hide_file.loading')}>\n            <LoadingIndicator />\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  displayIcon(fileIcon: string): Mithril.Children {\n    return (\n      <span\n        className=\"fof-file-icon\"\n        role=\"presentation\"\n        style={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          height: '100%', // Ensure the container takes up the necessary space\n        }}\n      >\n        {icon(`fa-fw ${fileIcon}`)}\n      </span>\n    );\n  }\n\n  actionItems(file: File): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    file.canViewInfo() &&\n      items.add(\n        'view-info',\n        <Button className=\"Button Button--icon fof-file-action\" icon=\"fas fa-info-circle\" aria-label=\"info\" onclick={() => this.viewFileInfo()} />,\n        100\n      );\n\n    const transPrefix = file.isShared() ? 'fof-upload.lib.file_list.hide_shared_file' : 'fof-upload.lib.file_list.hide_file';\n    const hideTranslation = app.translator.trans(this.file.hidden() ? `${transPrefix}.btn_a11y_label_show` : `${transPrefix}.btn_a11y_label_hide`, {\n      fileName: file.baseName(),\n    });\n\n    file.canHide() &&\n      items.add(\n        'hide-file',\n        <Tooltip text={hideTranslation} position=\"bottom\">\n          <Button\n            className=\"Button Button--icon fof-file-action\"\n            icon={this.file.hidden() ? 'fas fa-eye' : 'fas fa-eye-slash'}\n            aria-label={hideTranslation}\n            disabled={this.isFileHiding}\n            onclick={(e: Event) => this.hide(e)}\n          />\n        </Tooltip>,\n        80\n      );\n\n    const deleteTranslation = app.translator.trans('fof-upload.lib.file_list.delete_file_a11y_label', { fileName: file.baseName() });\n\n    file.canDelete() &&\n      items.add(\n        'delete-file',\n        <Tooltip text={deleteTranslation} position=\"bottom\">\n          <Button\n            className=\"Button Button--icon fof-file-action\"\n            icon=\"fas fa-trash\"\n            aria-label={deleteTranslation}\n            disabled={this.isFileHiding}\n            onclick={(e: MouseEvent) => this.confirmDelete(e)}\n          />\n        </Tooltip>,\n        60\n      );\n\n    return items;\n  }\n\n  // Function to call when image fails to load\n  handleImageError = () => {\n    this.imageLoaded = false;\n    this.fileIcon = 'fas fa-exclamation-triangle';\n    this.isSelectable = false;\n    m.redraw();\n  };\n\n  // Function to call when image loads successfully\n  handleImageLoad = () => {\n    this.imageLoaded = true;\n    m.redraw();\n  };\n\n  viewFileInfo() {\n    console.log('view file info');\n  }\n\n  hide(e: Event) {\n    e.stopPropagation();\n\n    // TODO: local logic, then:\n\n    if (this.attrs.onHide) {\n      this.attrs.onHide(this.file);\n    }\n  }\n\n  async confirmDelete(e: MouseEvent) {\n    e.stopPropagation();\n\n    if (confirm(extractText(app.translator.trans('fof-upload.lib.file_list.delete_confirmation', { fileName: this.file.baseName() })))) {\n      const uuid = this.file.uuid();\n      await app.request({\n        method: 'DELETE',\n        url: app.forum.attribute('apiUrl') + '/fof/upload/delete/' + uuid,\n      });\n\n      if (this.attrs.onDelete) {\n        this.attrs.onDelete(this.file);\n      }\n    }\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Alert'];","import app from 'flarum/common/app';\nimport Component, { ComponentAttrs } from 'flarum/common/Component';\nimport File from '../models/File';\nimport type Mithril from 'mithril';\nimport User from 'flarum/common/models/User';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport mimeToIcon from '../mimeToIcon';\nimport classList from 'flarum/common/utils/classList';\nimport Button from 'flarum/common/components/Button';\nimport DisplayFile from './DisplayFile';\nimport Alert from 'flarum/common/components/Alert';\nimport extractText from 'flarum/common/utils/extractText';\nimport FileListState from '../states/FileListState';\nimport { ApiPayloadSingle } from 'flarum/common/Store';\nimport icon from 'flarum/common/helpers/icon';\n\nexport interface FileListAttrs extends ComponentAttrs {\n  user: User | null;\n  selectable: boolean;\n  restrictFileType: string | string[];\n  selectedFiles: string[];\n  downloadOnClick: boolean;\n  onFileSelect: (file: File) => void | undefined;\n  onDelete: (file: File) => void | undefined;\n  fileState: FileListState;\n}\n\nexport default abstract class AbstractFileList extends Component<FileListAttrs> {\n  user: User | null = null;\n  inModal!: boolean;\n  restrictFileType!: string | string[] | null;\n  downloadOnClick!: boolean;\n  filesBeingHidden!: string[];\n  fileState!: FileListState;\n\n  public abstract loadFileList(): void;\n  abstract hasMoreResults(): boolean;\n  abstract loadMore(): void;\n  abstract isLoading(): boolean;\n  abstract fileCollection(): File[];\n\n  oninit(vnode: Mithril.Vnode<FileListAttrs, this>) {\n    super.oninit(vnode);\n\n    this.inModal = this.attrs.selectable;\n    this.restrictFileType = this.attrs.restrictFileType || null;\n    this.downloadOnClick = this.attrs.downloadOnClick || false;\n    this.filesBeingHidden = [];\n    this.fileState = this.attrs.fileState;\n\n    this.loadFileList();\n  }\n\n  view() {\n    return (\n      <div className=\"SharedFileList fof-upload-file-list\" aria-live=\"polite\">\n        {/* Loading */}\n        {this.isLoading() && this.fileCollection().length === 0 && (\n          <div className={'fof-upload-loading'}>\n            {app.translator.trans('fof-upload.lib.file_list.loading')}\n\n            <LoadingIndicator />\n          </div>\n        )}\n        {/* Empty file list */}\n        {!this.isLoading() && this.fileCollection().length === 0 && (\n          <div className=\"Placeholder\">\n            <p className=\"fof-upload-empty\">{app.translator.trans('fof-upload.lib.file_list.empty')}</p>\n          </div>\n        )}\n        {/* File list */}\n        <ul>\n          {this.fileCollection().map((file: File) => {\n            const fileIcon = mimeToIcon(file.type());\n            const fileSelectable = this.restrictFileType ? this.isSelectable(file) : true;\n\n            const fileClassNames = classList([\n              'fof-file',\n              // File is image\n              fileIcon === 'far fa-file-image' && 'fof-file-type-image',\n              // File is selected\n              this.attrs.selectedFiles && this.attrs.selectedFiles.indexOf(file.id() ?? '') >= 0 && 'fof-file-selected',\n            ]);\n\n            const isFileHiding = this.filesBeingHidden.includes(file.uuid());\n\n            return (\n              <li aria-busy={isFileHiding} key={file.uuid()}>\n                <DisplayFile\n                  file={file}\n                  fileSelectable={fileSelectable}\n                  isSelected={this.attrs.selectedFiles && this.attrs.selectedFiles.indexOf(file.id() ?? '') >= 0}\n                  fileClassNames={fileClassNames}\n                  isFileHiding={isFileHiding}\n                  onHide={this.hideFile.bind(this)}\n                  onFileClick={this.onFileClick.bind(this)}\n                  user={this.attrs.user}\n                  onDelete={this.onDelete.bind(this)}\n                />\n              </li>\n            );\n          })}\n        </ul>\n        {/* Load more files */}\n        {this.hasMoreResults() && (\n          <div className={'fof-load-more-files'}>\n            <Button className={'Button Button--primary'} disabled={this.isLoading()} loading={this.isLoading()} onclick={() => this.loadMore()}>\n              {app.translator.trans('fof-upload.lib.file_list.load_more_files_btn')}\n            </Button>\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  onDelete(file: File) {\n    if (this.attrs.onDelete) {\n      this.attrs.onDelete(file);\n    }\n  }\n\n  // Common methods like onFileClick, isSelectable, hideFile...\n\n  onFileClick(file: File) {\n    // Custom functionality\n    if (this.attrs.onFileSelect) {\n      this.attrs.onFileSelect(file);\n      return;\n    }\n\n    // Download on click\n    if (this.attrs.downloadOnClick) {\n      window.open(file.url());\n      return;\n    }\n  }\n\n  isSelectable(file: File) {\n    const fileType = file.type();\n\n    // Custom defined file types\n    if (Array.isArray(this.restrictFileType)) {\n      return this.restrictFileType.indexOf(fileType) >= 0;\n    }\n\n    // Image\n    else if (this.restrictFileType === 'image') {\n      return fileType.includes('image/');\n    }\n\n    // Audio\n    else if (this.restrictFileType === 'audio') {\n      return fileType.includes('audio/');\n    }\n\n    // Video\n    else if (this.restrictFileType === 'video') {\n      return fileType.includes('video/');\n    }\n\n    return false;\n  }\n\n  /**\n   * Begins the hiding process for a file.\n   *\n   * - Shows a native confirmation dialog\n   * - If confirmed, sends AJAX request to the hide file API\n   */\n  async hideFile(file: File) {\n    const uuid = file.uuid();\n\n    if (this.filesBeingHidden.includes(uuid)) return;\n\n    this.filesBeingHidden.push(uuid);\n\n    const transPrefix = file.isShared() ? 'fof-upload.lib.file_list.hide_shared_file' : 'fof-upload.lib.file_list.hide_file';\n\n    const confirmToggleHide = confirm(\n      extractText(\n        app.translator.trans(file.hidden() ? `${transPrefix}.show_confirmation` : `${transPrefix}.hide_confirmation`, {\n          fileName: file.baseName(),\n        })\n      )\n    );\n\n    if (confirmToggleHide) {\n      try {\n        const filePayload = await app.request<ApiPayloadSingle>({\n          method: 'PATCH',\n          url: `${app.forum.attribute('apiUrl')}/fof/upload/hide`,\n          body: { uuid },\n        });\n\n        app.store.pushPayload(filePayload);\n        m.redraw();\n\n        app.alerts.show(Alert, { type: 'success' }, [\n          icon(file.hidden() ? 'fas fa-eye-slash' : 'fas fa-eye'),\n          ' ',\n          app.translator.trans(file?.hidden() ? `${transPrefix}.hide_success` : `${transPrefix}.show_success`),\n        ]);\n\n        if (this.fileState.user) {\n          const index = this.fileState.files.findIndex((file: File) => uuid === file.uuid());\n          this.fileState.files.splice(index, 1);\n        }\n      } catch (error) {\n        app.alerts.show(\n          Alert,\n          { type: 'error' },\n          app.translator.trans(file?.hidden() ? `${transPrefix}.hide_fail` : `${transPrefix}.show_fail`, {\n            fileName: file.baseName(),\n          })\n        );\n      } finally {\n        // Remove file from hiding list\n        const i = this.filesBeingHidden.indexOf(uuid);\n        this.filesBeingHidden.splice(i, 1);\n      }\n    }\n  }\n}\n","import app from 'flarum/common/app';\nimport File from '../models/File';\nimport AbstractFileList from './AbstractFIleList';\nimport FileListState from '../states/FileListState';\n\nexport default class UserFileList extends AbstractFileList {\n  public loadFileList(): void {\n    //app.fileListState.setUser(this.attrs.user || app.session.user);\n    this.fileState.setUser(this.attrs.user || app.session.user);\n    /**\n     * The user who's media we are dealing with\n     */\n    this.user = this.fileState.user; //app.fileListState.user;\n  }\n\n  hasMoreResults(): boolean {\n    return this.fileState.hasMoreResults();\n  }\n\n  loadMore(): void {\n    this.fileState.loadMore();\n  }\n\n  isLoading(): boolean {\n    return this.fileState.isLoading();\n  }\n\n  fileCollection(): File[] {\n    return this.fileState.files;\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Switch'];","import app from 'flarum/common/app';\nimport Modal, { IInternalModalAttrs } from 'flarum/common/components/Modal';\nimport Switch from 'flarum/common/components/Switch';\nimport mimeToIcon from '../mimeToIcon';\nimport Button from 'flarum/common/components/Button';\nimport type Mithril from 'mithril';\nimport { ApiResponsePlural } from 'flarum/common/Store';\nimport File from '../models/File';\n\ninterface CustomAttrs extends IInternalModalAttrs {\n  onUploadComplete: (files: File | File[]) => void;\n}\n\nexport default class UploadSharedFileModal extends Modal<CustomAttrs> {\n  files = [];\n  fileInput = null;\n  options = {\n    shared: true,\n    hidden: false,\n  };\n  loading: boolean = false;\n\n  oninit(vnode: Mithril.Vnode<CustomAttrs, this>) {\n    super.oninit(vnode);\n  }\n\n  className() {\n    return 'UploadSharedFileModal Modal--medium';\n  }\n\n  title() {\n    return app.translator.trans('fof-upload.lib.upload-shared-file-modal.title');\n  }\n\n  onFileChange(e) {\n    this.addFiles(Array.from(e.target.files));\n  }\n\n  addFiles(newFiles: File[]) {\n    (this.files as File[]).push(...newFiles);\n    m.redraw();\n  }\n\n  onDragOver(e) {\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  onDrop(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    if (e.dataTransfer && e.dataTransfer.files) {\n      this.addFiles(Array.from(e.dataTransfer.files));\n    }\n  }\n\n  onDropzoneClick() {\n    if (this.fileInput) {\n      this.fileInput.click();\n    }\n  }\n\n  content() {\n    return (\n      <div className=\"Modal-body\">\n        <div\n          className=\"UploadSharedFileModal-dropzone\"\n          onclick={() => this.onDropzoneClick()}\n          ondragover={this.onDragOver.bind(this)}\n          ondrop={this.onDrop.bind(this)}\n        >\n          {app.translator.trans('fof-upload.lib.upload-shared-file-modal.dropzone')}\n          <input\n            type=\"file\"\n            multiple\n            onchange={this.onFileChange.bind(this)}\n            style={{ opacity: 0, position: 'absolute', left: '-9999px' }}\n            oncreate={(vnode) => {\n              this.fileInput = vnode.dom;\n            }}\n          />\n        </div>\n        <div className=\"UploadSharedFileModal-files\">\n          {this.files.map((file: File) => {\n            const isImage = file.type.startsWith('image/');\n            return (\n              <div className=\"UploadedFile\">\n                {isImage ? <img src={URL.createObjectURL(file)} alt={file.name} /> : <i className={mimeToIcon(file.type)}></i>}\n                <div className=\"UploadedFile-name\">{file.name}</div>\n                {/* Remove button */}\n                <Button\n                  className=\"Button Button--icon Button--link UploadedFile-remove\"\n                  icon=\"fas fa-times\"\n                  onclick={() => {\n                    this.files = this.files.filter((f) => f !== file);\n                  }}\n                />\n              </div>\n            );\n          })}\n        </div>\n        <div className=\"UploadSharedFileModal-options Form-group\">\n          <Switch state={this.options.hidden} onchange={(value: boolean) => (this.options.hidden = value)}>\n            {app.translator.trans('fof-upload.lib.upload-shared-file-modal.hide-from-media-gallery')}\n          </Switch>\n        </div>\n        <div className=\"UploadSharedFileModal-submit App-primaryControl\">\n          <Button\n            className=\"Button Button--primary\"\n            loading={this.loading}\n            onclick={this.upload.bind(this)}\n            disabled={!this.files.length || this.loading}\n          >\n            {app.translator.trans('fof-upload.lib.upload-shared-file-modal.upload')}\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  async upload() {\n    this.loading = true;\n    m.redraw();\n\n    const formData = new FormData();\n\n    // Append each file to the form data\n    this.files.forEach((file) => {\n      formData.append('files[]', file);\n    });\n\n    Object.keys(this.options).forEach((key) => {\n      formData.append(`options[${key}]`, this.options[key]);\n    });\n\n    const results = await app.request<ApiResponsePlural<File>>({\n      method: 'POST',\n      url: app.forum.attribute('apiUrl') + '/fof/upload',\n      serialize: (raw: FormData) => raw, // Prevent mithril from trying to serialize FormData\n      body: formData,\n    });\n\n    const uploadedFiles = app.store.pushPayload(results);\n\n    this.attrs.onUploadComplete(uploadedFiles);\n    this.files = [];\n    this.hide();\n\n    this.loading = false;\n    m.redraw();\n  }\n}\n","import app from 'flarum/common/app';\nimport File from '../models/File';\nimport AbstractFileList from './AbstractFIleList';\n\nexport default class SharedFileList extends AbstractFileList {\n  public loadFileList(): void {\n    this.fileState.loadResults();\n  }\n\n  hasMoreResults() {\n    return this.fileState.hasMoreResults();\n  }\n\n  loadMore() {\n    this.fileState.loadMore();\n  }\n\n  isLoading(): boolean {\n    return this.fileState.isLoading();\n  }\n\n  fileCollection(): File[] {\n    return this.fileState.files;\n  }\n}\n","import app from 'flarum/common/app';\nimport User from 'flarum/common/models/User';\nimport File from '../models/File';\nimport { ApiQueryParamsPlural, ApiResponsePlural } from 'flarum/common/Store';\n\nexport default class FileListState {\n  public user: User | null;\n  public files: File[];\n  private moreResults: boolean;\n  private loading: boolean;\n  private sharedFiles: boolean;\n\n  constructor(sharedFiles: boolean = false) {\n    this.user = null;\n    this.files = [];\n    this.moreResults = false;\n    this.loading = false;\n    this.sharedFiles = sharedFiles;\n  }\n\n  /**\n   * Set the user and load their file list.\n   * @param user The user whose files to load.\n   */\n  public setUser(user: User): void {\n    if (user === this.user) return;\n\n    this.user = user;\n    this.files = [];\n    this.loadResults();\n  }\n\n  public refresh(): void {\n    this.files = [];\n    this.loadResults();\n    m.redraw();\n  }\n\n  /**\n   * Load more files for the current user, starting from the given offset.\n   * @param offset The starting index for loading more files.\n   * @returns A promise resolving to the loaded files.\n   */\n  public async loadResults(offset: number = 0): Promise<ApiResponsePlural<File>> {\n    if (!this.sharedFiles && !this.user) return Promise.reject('User not set');\n\n    this.loading = true;\n\n    let route: string = 'fof/uploads';\n    let params: ApiQueryParamsPlural = {};\n\n    if (!this.sharedFiles && this.user) {\n      params = {\n        filter: { user: this.user.id() },\n        page: { offset },\n      } as ApiQueryParamsPlural;\n    } else {\n      route = 'fof/upload/shared-files';\n      params = {\n        page: { offset },\n      } as ApiQueryParamsPlural;\n    }\n\n    const results = await app.store.find<File[]>(route, params);\n\n    return this.parseResults(results);\n  }\n\n  /**\n   * Load the next set of results.\n   */\n  public async loadMore(): Promise<ApiResponsePlural<File>> {\n    this.loading = true;\n    return this.loadResults(this.files.length);\n  }\n\n  private parseResults(results: ApiResponsePlural<File>): ApiResponsePlural<File> {\n    this.files = this.files.concat(results);\n    this.loading = false;\n    this.moreResults = !!results.payload?.links?.next;\n    m.redraw();\n    return results;\n  }\n\n  /**\n   * Add files to the beginning of the list.\n   * @param files The files to be added.\n   */\n  public addToList(files: File | File[]): void {\n    if (Array.isArray(files)) {\n      this.files.unshift(...files);\n    } else {\n      this.files.unshift(files);\n    }\n    m.redraw();\n  }\n\n  /**\n   * Remove files from the list.\n   * @param files The files to be removed.\n   */\n  public removeFromList(files: File | File[]): void {\n    if (Array.isArray(files)) {\n      this.files = this.files.filter((file) => !files.includes(file));\n    } else {\n      this.files = this.files.filter((file) => file !== files);\n    }\n\n    m.redraw();\n  }\n\n  /**\n   * Check if there are files in the list.\n   * @returns True if there are files, false otherwise.\n   */\n  public hasFiles(): boolean {\n    return this.files.length > 0;\n  }\n\n  /**\n   * Check if the file list is currently loading.\n   * @returns True if loading, false otherwise.\n   */\n  public isLoading(): boolean {\n    return this.loading;\n  }\n\n  /**\n   * Check if there are more files to load.\n   * @returns True if there are more files, false otherwise.\n   */\n  public hasMoreResults(): boolean {\n    return this.moreResults;\n  }\n\n  /**\n   * Check if the user has no files and the list is not loading.\n   * @returns True if the list is empty and not loading, false otherwise.\n   */\n  public empty(): boolean {\n    return !this.hasFiles() && !this.isLoading();\n  }\n}\n","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport Button from 'flarum/common/components/Button';\nimport UploadButton from './UploadButton';\nimport UserFileList from '../../common/components/UserFileList';\nimport DragAndDrop from './DragAndDrop';\nimport UploadSharedFileModal from '../../common/components/UploadSharedFileModal';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport SharedFileList from '../../common/components/SharedFileList';\nimport FileListState from '../../common/states/FileListState';\n\nexport default class FileManagerModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    // Initialize upload managers\n    this.uploader = vnode.attrs.uploader;\n\n    // Current selected files\n    this.selectedFiles = [];\n\n    // Allow multiselect\n    this.multiSelect = vnode.attrs.multiSelect === undefined ? true : vnode.attrs.multiSelect;\n\n    // Restrict file selection to specific types\n    this.restrictFileType = vnode.attrs.restrictFileType || null;\n\n    // Drag & drop\n    this.dragDrop = null;\n\n    this.selectedFilesLibrary = vnode.attrs.defaultFilesLibrary || 'user';\n\n    this.sharedUploads = null;\n\n    this.userFileState = new FileListState();\n    this.sharedFileState = new FileListState(true);\n\n    this.uploader.setState(this.userFileState);\n\n    // Initialize uploads\n    this.onUpload();\n  }\n\n  className() {\n    return 'Modal--large fof-file-manager-modal';\n  }\n\n  /**\n   * Initialize drag & drop\n   */\n  oncreate(vnode) {\n    super.oncreate(vnode);\n\n    this.dragDrop = new DragAndDrop((files) => this.uploader.upload(files, false), this.$().find('.Modal-content')[0]);\n  }\n\n  /**\n   * Remove events from modal content\n   */\n  onremove() {\n    if (this.dragDrop) {\n      this.dragDrop.unload();\n    }\n  }\n\n  view() {\n    const fileCount = this.selectedFiles.length;\n    const { hideUser, hideShared } = this.attrs;\n\n    return (\n      <div className={`Modal modal-dialog ${this.className()}`}>\n        <div className=\"Modal-content\">\n          <div className=\"fof-modal-buttons App-backControl\">\n            {!hideUser && this.selectedFilesLibrary === 'user' && (\n              <UploadButton uploader={this.uploader} disabled={this.userFileState.isLoading()} isMediaUploadButton />\n            )}\n            {app.session.user && app.session.user.uploadSharedFiles() && !hideShared && this.selectedFilesLibrary === 'shared' && (\n              <Button\n                className=\"Button\"\n                icon=\"fas fa-file-upload\"\n                onclick={() => {\n                  this.showUploadModal();\n                }}\n              >\n                {app.translator.trans('fof-upload.forum.buttons.upload')}\n              </Button>\n            )}\n          </div>\n\n          <div className=\"fof-drag-and-drop\">\n            <div className=\"fof-drag-and-drop-release\">\n              <i className=\"fas fa-cloud-upload-alt\" />\n\n              {app.translator.trans('fof-upload.lib.file_list.release_to_upload')}\n            </div>\n          </div>\n\n          <div className=\"Modal-header\">\n            <h3 className=\"App-titleControl App-titleControl--text\">{app.translator.trans('fof-upload.forum.media_manager')}</h3>\n            {app.session.user?.accessSharedFiles() && !hideUser && !hideShared && (\n              <div className=\"LibrarySelection\">{this.fileLibraryButtonItems().toArray()}</div>\n            )}\n          </div>\n\n          {this.alertAttrs && (\n            <div className=\"Modal-alert\">\n              <Alert {...this.alertAttrs} />\n            </div>\n          )}\n\n          <div className=\"Modal-body\">\n            {this.selectedFilesLibrary === 'user' && this.userFilesContent()}\n            {this.selectedFilesLibrary === 'shared' && this.sharedFilesContent()}\n          </div>\n\n          <div className=\"Modal-footer\">\n            <Button onclick={this.hide.bind(this)} className=\"Button\">\n              {app.translator.trans('fof-upload.forum.buttons.cancel')}\n            </Button>\n\n            <Button\n              onclick={this.onSelect.bind(this)}\n              disabled={this.selectedFiles.length === 0 || (!this.multiSelect && this.selectedFiles.length > 1)}\n              className=\"Button Button--primary\"\n            >\n              {app.translator.trans('fof-upload.lib.file_list.confirm_selection_btn', { fileCount })}\n            </Button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  fileLibraryButtonItems() {\n    const items = new ItemList();\n\n    items.add(\n      'user',\n      <Button className={`Button Button--flat ${this.selectedFilesLibrary === 'user' ? 'active' : ''}`} onclick={() => this.setLibrary('user')}>\n        {app.translator.trans('fof-upload.forum.buttons.media')}\n      </Button>\n    );\n\n    items.add(\n      'shared',\n      <Button className={`Button Button--flat ${this.selectedFilesLibrary === 'shared' ? 'active' : ''}`} onclick={() => this.setLibrary('shared')}>\n        {app.translator.trans('fof-upload.forum.buttons.shared_media')}\n      </Button>\n    );\n\n    return items;\n  }\n\n  setLibrary(library) {\n    this.selectedFilesLibrary = library;\n    m.redraw();\n  }\n\n  userFilesContent() {\n    return (\n      <UserFileList\n        user={this.attrs.user}\n        selectable\n        onFileSelect={this.onFileSelect.bind(this)}\n        selectedFiles={this.selectedFiles}\n        restrictFileType={this.restrictFileType}\n        fileState={this.userFileState}\n        onDelete={this.onDelete.bind(this)}\n      />\n    );\n  }\n\n  sharedFilesContent() {\n    return (\n      <SharedFileList\n        selectable\n        onFileSelect={this.onFileSelect.bind(this)}\n        selectedFiles={this.selectedFiles}\n        restrictFileType={this.restrictFileType}\n        user={this.attrs.user}\n        fileState={this.sharedFileState}\n        onDelete={this.onDelete.bind(this)}\n      />\n    );\n  }\n\n  /**\n   * Add or remove file from selected files\n   *\n   * @param {File} file\n   */\n  onFileSelect(file) {\n    const itemPosition = this.selectedFiles.indexOf(file.id());\n\n    if (itemPosition >= 0) {\n      this.selectedFiles.splice(itemPosition, 1);\n    } else {\n      if (this.multiSelect) {\n        this.selectedFiles.push(file.id());\n      } else {\n        this.selectedFiles = [file.id()];\n      }\n    }\n  }\n\n  /**\n   * Add files to file list after upload\n   */\n  onUpload() {\n    this.uploader.on('success', ({ file }) => {\n      if (this.multiSelect) {\n        this.selectedFiles.push(file.id());\n      } else {\n        this.selectedFiles = [file.id()];\n      }\n    });\n  }\n\n  /**\n   * Add selected files to the composer\n   */\n  onSelect() {\n    this.hide();\n\n    // Custom callback\n    if (this.attrs.onSelect) {\n      this.attrs.onSelect(this.selectedFiles);\n\n      return;\n    }\n\n    // Add selected files to composer\n    this.selectedFiles.map((fileId) => {\n      const file = app.store.getById('files', fileId) || app.store.getById('shared-files', fileId);\n\n      app.composer.editor.insertAtCursor(file.bbcode() + '\\n', false);\n    });\n  }\n\n  showUploadModal() {\n    app.modal.show(\n      UploadSharedFileModal,\n      {\n        onUploadComplete: (files) => {\n          this.sharedFileState.addToList(files);\n        },\n      },\n      true\n    );\n  }\n\n  onDelete(file) {\n    this.sharedFileState.removeFromList(file);\n    this.userFileState.removeFromList(file);\n  }\n}\n","import app from 'flarum/forum/app';\nimport Component, { ComponentAttrs } from 'flarum/common/Component';\nimport Button from 'flarum/common/components/Button';\nimport FileManagerModal from './FileManagerModal';\nimport Tooltip from 'flarum/common/components/Tooltip';\n\ninterface FileManagerButtonAttrs extends ComponentAttrs {\n  uploader: any;\n}\n\nexport default class FileManagerButton extends Component<FileManagerButtonAttrs> {\n  view() {\n    return (\n      <Tooltip text={app.translator.trans('fof-upload.forum.buttons.media')}>\n        {Button.component({\n          className: 'Button fof-upload-button Button--icon',\n          onclick: this.fileManagerButtonClicked.bind(this),\n          icon: 'fas fa-photo-video',\n        })}\n      </Tooltip>\n    );\n  }\n\n  /**\n   * Event handler for upload button being clicked\n   */\n  fileManagerButtonClicked(e: PointerEvent) {\n    e.preventDefault();\n\n    // Open dialog\n    app.modal.show(FileManagerModal, {\n      uploader: this.attrs.uploader,\n    });\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/UserPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LinkButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extenders'];","import Model from 'flarum/common/Model';\n\nexport default class File extends Model {\n  baseName() {\n    return Model.attribute<string>('baseName').call(this);\n  }\n\n  path() {\n    return Model.attribute<string>('path').call(this);\n  }\n\n  url() {\n    return Model.attribute<string>('url').call(this);\n  }\n\n  size() {\n    return Model.attribute<number>('size').call(this);\n  }\n\n  type() {\n    return Model.attribute<string>('type').call(this);\n  }\n\n  humanSize() {\n    return Model.attribute<string>('humanSize').call(this);\n  }\n\n  createdAt() {\n    return Model.attribute('createdAt', Model.transformDate).call(this);\n  }\n\n  uuid() {\n    return Model.attribute<string>('uuid').call(this);\n  }\n\n  tag() {\n    return Model.attribute<string>('tag').call(this);\n  }\n\n  hidden() {\n    return Model.attribute<boolean>('hidden').call(this);\n  }\n\n  bbcode() {\n    return Model.attribute<string>('bbcode').call(this);\n  }\n\n  isShared() {\n    return Model.attribute<boolean>('shared').call(this);\n  }\n\n  isPrivateShared() {\n    return Model.attribute<boolean>('isPrivateShared').call(this);\n  }\n\n  canViewInfo() {\n    return Model.attribute<boolean>('canViewInfo').call(this);\n  }\n\n  canHide() {\n    return Model.attribute<boolean>('canHide').call(this);\n  }\n\n  canDelete() {\n    return Model.attribute<boolean>('canDelete').call(this);\n  }\n\n  apiEndpoint() {\n    return '/fof/uploads' + (this.exists ? '/' + this.id() : '');\n  }\n}\n","import Extend from 'flarum/common/extenders';\nimport File from './models/File';\n\nexport default [\n  new Extend.Store() //\n    .add('files', File)\n    .add('shared-files', File),\n];\n","import app from 'flarum/forum/app';\nimport UserPage from 'flarum/forum/components/UserPage';\nimport UserFileList from '../../common/components/UserFileList';\nimport type Mithril from 'mithril';\nimport User from 'flarum/common/models/User';\nimport FileListState from '../../common/states/FileListState';\n\nimport type File from '../../common/models/File';\n\nexport default class UploadsUserPage extends UserPage {\n  fileState!: FileListState;\n\n  oninit(vnode: Mithril.Vnode<this>) {\n    super.oninit(vnode);\n\n    this.user = null;\n    this.fileState = new FileListState();\n\n    this.loadUser(m.route.param('username'));\n  }\n\n  content() {\n    if (app.session.user && (app.session.user.viewOthersMediaLibrary() || this.user === app.session.user)) {\n      return (\n        this.user &&\n        UserFileList.component({\n          user: this.user,\n          selectable: false,\n          downloadOnClick: true,\n          fileState: this.fileState,\n          onDelete: this.onDelete.bind(this),\n        })\n      );\n    } else {\n      return null;\n    }\n  }\n\n  onDelete(file: File) {\n    this.fileState.removeFromList(file);\n  }\n\n  show(user: User) {\n    super.show(user);\n    this.user = user;\n  }\n}\n","import User from 'flarum/common/models/User';\nimport { default as extend } from '../common/extend';\nimport Extend from 'flarum/common/extenders';\nimport UploadsUserPage from './components/UploadsUserPage';\n\nexport default [\n  ...extend,\n\n  // Not using the new extender yet, thinking about if to change the serialized names,\n  // or the js property names, as we can't change the key->attribute name via the extender,\n  // like we used to do with ie `User.prototype.viewOthersMediaLibrary = Model.attribute('fof-upload-viewOthersMediaLibrary');`\n  // new Extend.Model(User) //\n  //     .attribute<boolean>('fof-upload-viewOthersMediaLibrary')\n  //     .attribute<boolean>('fof-upload-deleteOthersMediaLibrary')\n  //     .attribute<number>('fof-upload-uploadCountCurrent')\n  //     .attribute<number>('fof-upload-uploadCountAll'),\n\n  new Extend.Routes() //\n    .add('user.uploads', '/u/:username/uploads', UploadsUserPage),\n];\n","function _extends() {\n  return _extends = Object.assign ? Object.assign.bind() : function (n) {\n    for (var e = 1; e < arguments.length; e++) {\n      var t = arguments[e];\n      for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]);\n    }\n    return n;\n  }, _extends.apply(null, arguments);\n}\nexport { _extends as default };","import Component, { ComponentAttrs } from 'flarum/common/Component';\nimport Button from 'flarum/common/components/Button';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport type Mithril from 'mithril';\nimport mimeToIcon from '../mimeToIcon';\nimport File from '../models/File';\nimport icon from 'flarum/common/helpers/icon';\nimport app from 'flarum/common/app';\nimport classList from 'flarum/common/utils/classList';\n\ninterface CustomAttrs extends ComponentAttrs {\n  file: File;\n  selectable: boolean;\n  fileClassNames: string;\n  onDelete: (file: File) => void | undefined;\n  onFileSelect: (file: File) => void | undefined;\n}\n\nexport default class UploadedFile extends Component<CustomAttrs> {\n  file!: File;\n  callback!: () => void | undefined;\n  imageLoaded: boolean = true;\n\n  oninit(vnode: Mithril.Vnode<CustomAttrs, this>) {\n    super.oninit(vnode);\n\n    this.file = this.attrs.file;\n  }\n\n  view() {\n    const isImage = this.file.type().startsWith('image/');\n    const fileIcon = mimeToIcon(this.file.type());\n    const errorIcon = 'fas fa-exclamation-triangle';\n    const statusIcon = this.file.isPrivateShared() ? 'fas fa-lock' : 'fas fa-unlock';\n\n    return (\n      <div className=\"UploadedFile\" key={this.file.uuid()}>\n        <div className=\"UploadedFile--sharestatus\">\n          <span>\n            {icon(statusIcon)}\n            {this.file.baseName()}\n          </span>\n        </div>\n        <div className=\"UploadedFile--preview\" onclick={() => this.onFileClick(this.file)}>\n          {isImage ? (\n            this.imageLoaded ? (\n              <img\n                className={this.attrs.fileClassNames}\n                src={this.file.url()}\n                loading=\"lazy\"\n                onerror={this.handleImageError}\n                onload={this.handleImageLoad}\n                alt={this.file.baseName()}\n              />\n            ) : (\n              icon(errorIcon, { className: 'icon-fallback' }) // Error icon for failed image load\n            )\n          ) : (\n            icon(fileIcon, { className: 'icon-fallback' }) // Icon representing the file type\n          )}\n        </div>\n        <div className=\"UploadedFile--actions\">{this.actionItems().toArray()}</div>\n      </div>\n    );\n  }\n\n  actionItems(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    items.add(\n      'view-info',\n      <Button className=\"Button Button--icon\" icon=\"fas fa-info-circle\" onclick={() => this.viewFileInfo()} aria-label=\"info\" />\n    );\n\n    items.add(\n      'download',\n      <Button className=\"Button Button--icon\" icon=\"fas fa-download\" onclick={() => window.open(this.file.url())} aria-label=\"download\" />\n    );\n\n    const hideFileIcon = this.file.isPrivateShared() ? 'fas fa-lock' : this.file.hidden() ? 'fas fa-eye' : 'fas fa-eye-slash';\n    items.add('hide-file', <Button className=\"Button Button--icon\" icon={hideFileIcon} onclick={() => this.hideFile()} aria-label=\"hide\" />);\n\n    items.add('delete', <Button className=\"Button Button--icon\" icon=\"fas fa-trash\" onclick={() => this.confirmDelete()} aria-label=\"delete\" />);\n\n    return items;\n  }\n\n  async confirmDelete() {\n    let result = confirm('Are you sure you want to delete this file?');\n\n    if (result) {\n      const uuid = this.file.uuid();\n      await app.request({\n        method: 'DELETE',\n        url: app.forum.attribute('apiUrl') + '/fof/upload/delete/' + uuid,\n      });\n\n      if (this.attrs.onDelete) {\n        this.attrs.onDelete(this.file);\n      }\n    }\n  }\n\n  viewFileInfo() {\n    // TODO:\n    console.log('view file info');\n  }\n\n  hideFile() {\n    // TODO:\n    console.log('hide file');\n  }\n\n  // Function to call when image fails to load\n  handleImageError = () => {\n    this.imageLoaded = false;\n    m.redraw();\n  };\n\n  // Function to call when image loads successfully\n  handleImageLoad = () => {\n    this.imageLoaded = true;\n    m.redraw();\n  };\n\n  onFileClick(file: File) {\n    if (this.attrs.onFileSelect) {\n      this.attrs.onFileSelect(file);\n      return;\n    }\n  }\n}\n","import Uploader from '../handler/Uploader';\nimport DragAndDrop from './DragAndDrop';\nimport FileManagerButton from './FileManagerButton';\nimport FileManagerModal from './FileManagerModal';\nimport UploadButton from './UploadButton';\nimport { commonComponents } from '../../common/components';\n\nexport const components = {\n  ...commonComponents,\n  DragAndDrop,\n  FileManagerButton,\n  FileManagerModal,\n  Uploader,\n  UploadButton,\n};\n","import UploadSharedFileModal from './UploadSharedFileModal';\nimport UploadedFile from './UploadedFile';\nimport UserFileList from './UserFileList';\n\nexport const commonComponents = {\n  UploadedFile,\n  UploadSharedFileModal,\n  UserFileList,\n};\n","import app from 'flarum/forum/app';\nimport User from 'flarum/common/models/User';\nimport Model from 'flarum/common/Model';\nimport downloadButtonInteraction from './downloadButtonInteraction';\nimport addUploadButton from './addUploadButton';\nimport addUserPageButton from './addUserPageButton';\n\nexport { default as extend } from './extend';\nexport * from './components';\n\napp.initializers.add('fof-upload', () => {\n  // Leaving these here for now.\n  // @see ./extend.ts\n  User.prototype.viewOthersMediaLibrary = Model.attribute('fof-upload-viewOthersMediaLibrary');\n  User.prototype.deleteOthersMediaLibrary = Model.attribute('fof-upload-deleteOthersMediaLibrary');\n  User.prototype.uploadCountCurrent = Model.attribute('fof-upload-uploadCountCurrent');\n  User.prototype.uploadCountAll = Model.attribute('fof-upload-uploadCountAll');\n  User.prototype.uploadSharedFiles = Model.attribute('fof-upload-uploadSharedFiles');\n  User.prototype.accessSharedFiles = Model.attribute('fof-upload-accessSharedFiles');\n\n  //app.fileListState = new FileListState();\n\n  addUploadButton();\n  downloadButtonInteraction();\n  addUserPageButton();\n});\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport TextEditor from 'flarum/common/components/TextEditor';\nimport UploadButton from './components/UploadButton';\nimport DragAndDrop from './components/DragAndDrop';\nimport PasteClipboard from './components/PasteClipboard';\nimport Uploader from './handler/Uploader';\nimport FileManagerButton from './components/FileManagerButton';\n\nexport default function () {\n  extend(TextEditor.prototype, 'oninit', function () {\n    this.uploader = new Uploader();\n  });\n  extend(TextEditor.prototype, 'controlItems', function (items) {\n    if (!app.forum.attribute('fof-upload.canUpload')) return;\n\n    const composerButtonVisiblity = app.forum.attribute('fof-upload.composerButtonVisiblity');\n\n    // Add media button\n    if (composerButtonVisiblity === 'both' || composerButtonVisiblity === 'media-btn') {\n      items.add(\n        'fof-upload-media',\n        FileManagerButton.component({\n          uploader: this.uploader,\n        })\n      );\n    }\n\n    // Add upload button\n    if (composerButtonVisiblity === 'both' || composerButtonVisiblity === 'upload-btn') {\n      items.add(\n        'fof-upload',\n        UploadButton.component({\n          uploader: this.uploader,\n        })\n      );\n    }\n  });\n\n  extend(TextEditor.prototype, 'oncreate', function (f_, vnode) {\n    if (!app.forum.attribute('fof-upload.canUpload')) return;\n\n    this.uploader.on('success', ({ file, addBBcode }) => {\n      if (!addBBcode) return;\n\n      this.attrs.composer.editor.insertAtCursor(file.bbcode() + '\\n', false);\n\n      // We wrap this in a typeof check to prevent it running when a user\n      // is creating a new discussion. There's nothing to preview in a new\n      // discussion, so the `preview` function isn't defined.\n      if (typeof this.attrs.preview === 'function') {\n        // Scroll the preview into view\n        // preview() causes the composer to close on mobile, but we don't want that. We want only the scroll\n        // We work around that by temporarily patching the isFullScreen method\n        const originalIsFullScreen = app.composer.isFullScreen;\n\n        app.composer.isFullScreen = () => false;\n\n        this.attrs.preview();\n\n        app.composer.isFullScreen = originalIsFullScreen;\n      }\n    });\n\n    // Gracefully fail if the TextEditor was used in a non-Composer context\n    // Using a custom method to retrieve the target allows other extensions to still use this feature by returning an alternate container\n    const dragAndDropTarget = this.fofUploadDragAndDropTarget();\n\n    if (dragAndDropTarget) {\n      this.dragAndDrop = new DragAndDrop((files) => this.uploader.upload(files), dragAndDropTarget);\n    }\n\n    new PasteClipboard((files) => this.uploader.upload(files), this.$('.TextEditor-editor')[0]);\n  });\n\n  extend(TextEditor.prototype, 'onremove', function (f_, vnode) {\n    if (!app.forum.attribute('fof-upload.canUpload')) return;\n\n    if (this.dragAndDrop) {\n      this.dragAndDrop.unload();\n    }\n  });\n\n  TextEditor.prototype.fofUploadDragAndDropTarget = function () {\n    return this.$().parents('.Composer')[0];\n  };\n}\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport Post from 'flarum/forum/components/Post';\n\n/* global $ */\n\nexport default function () {\n  extend(Post.prototype, 'oncreate', function () {\n    this.$('[data-fof-upload-download-uuid]')\n      .unbind('click')\n      .on('click', (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n\n        if (!app.forum.attribute('fof-upload.canDownload')) {\n          alert(app.translator.trans('fof-upload.forum.states.unauthorized'));\n          return;\n        }\n\n        let url = app.forum.attribute('apiUrl') + '/fof/download';\n\n        url += '/' + encodeURIComponent(e.currentTarget.dataset.fofUploadDownloadUuid);\n        url += '/' + encodeURIComponent(this.attrs.post.id());\n        url += '/' + encodeURIComponent(app.session.csrfToken);\n\n        window.open(url);\n      });\n  });\n}\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport UserPage from 'flarum/forum/components/UserPage';\nimport LinkButton from 'flarum/common/components/LinkButton';\n\nexport default function addUserPageButton() {\n  extend(UserPage.prototype, 'navItems', function (items) {\n    const canUpload = !!app.forum.attribute('fof-upload.canUpload');\n    const hasUploads = !!this.user.uploadCountCurrent();\n\n    if (app.session.user && (app.session.user.viewOthersMediaLibrary() || (this.user === app.session.user && (canUpload || hasUploads)))) {\n      const uploadCount = this.user.uploadCountCurrent();\n\n      items.add(\n        'uploads',\n        LinkButton.component(\n          {\n            href: app.route('user.uploads', {\n              username: this.user.slug(),\n            }),\n            name: 'uploads',\n            icon: 'fas fa-file-upload',\n          },\n          [\n            this.user === app.session.user\n              ? app.translator.trans('fof-upload.forum.buttons.media')\n              : app.translator.trans('fof-upload.forum.buttons.user_uploads'),\n            ' ',\n            uploadCount > 0 ? <span className=\"Button-badge\">{uploadCount}</span> : '',\n          ]\n        ),\n        80\n      );\n    }\n  });\n}\n"],"names":["_typeof","require","_regeneratorRuntime","module","exports","e","__esModule","t","r","Object","prototype","n","hasOwnProperty","o","defineProperty","value","i","Symbol","a","iterator","c","asyncIterator","u","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","call","h","l","f","s","y","GeneratorFunction","GeneratorFunctionPrototype","p","this","d","getPrototypeOf","v","values","g","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","resolve","__await","then","callInvokeWithMethodAndArg","Error","done","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","isNaN","length","displayName","isGeneratorFunction","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","reverse","pop","prev","charAt","slice","stop","rval","handle","complete","finish","delegateYield","runtime","regeneratorRuntime","accidentalStrictMode","globalThis","Function","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","getter","definition","key","get","obj","prop","flarum","core","compat","_setPrototypeOf","bind","_inheritsLoose","UploadButton","_Component","apply","arguments","_proto","oninit","vnode","_this","attrs","uploader","on","$","m","redraw","isMediaUploadButton","view","buttonText","uploading","app","trans","TextEditorButton","className","classList","icon","onclick","uploadButtonClicked","disabled","title","LoadingIndicator","size","display","multiple","onchange","process","files","upload","click","Component","DragAndDrop","composerElement","handlers","supportsFileDragging","addEventListener","out","dropping","div","document","createElement","window","unload","removeEventListener","isNotFile","event","dataTransfer","items","kind","preventDefault","over","add","remove","PasteClipboard","element","paste","clipboardData","indexOf","getAsFile","Uploader","callbacks","success","failure","uploaded","setState","fileState","callback","dispatch","response","addBBcode","body","FormData","append","url","attribute","serialize","raw","result","error","errors","code","includes","clear","show","detail","_this2","data","file","_this2$fileState","fileObj","pushObject","addToList","asyncGeneratorStep","_asyncToGenerator","_next","_throw","mimeToIconMap","Map","mimeToIcon","fileType","startsWith","DisplayFile","_len","args","Array","_key","concat","isFileHiding","imageLoaded","fileIcon","isSelected","isSelectable","handleImageError","handleImageLoad","fileSelectable","onbeforeupdate","isImage","fileSelectedClass","uuid","onFileClick","src","draggable","onerror","onload","alt","baseName","displayIcon","actionItems","toArray","Tooltip","text","class","role","style","alignItems","justifyContent","height","_this3","ItemList","canViewInfo","Button","viewFileInfo","transPrefix","isShared","hideTranslation","hidden","fileName","canHide","position","hide","deleteTranslation","canDelete","confirmDelete","console","log","stopPropagation","onHide","_confirmDelete","_callee","_context","confirm","extractText","onDelete","_x","AbstractFileList","user","inModal","restrictFileType","downloadOnClick","filesBeingHidden","selectable","loadFileList","isLoading","fileCollection","map","_file$id","_file$id2","fileClassNames","selectedFiles","id","hideFile","hasMoreResults","loading","loadMore","onFileSelect","open","isArray","_hideFile","filePayload","index","pushPayload","Alert","findIndex","splice","t0","UserFileList","_AbstractFileList","setUser","UploadSharedFileModal","_Modal","fileInput","options","shared","onFileChange","addFiles","from","target","newFiles","_ref","onDragOver","onDrop","onDropzoneClick","content","ondragover","ondrop","opacity","left","oncreate","dom","URL","createObjectURL","filter","Switch","state","_upload","formData","results","uploadedFiles","onUploadComplete","Modal","SharedFileList","loadResults","FileListState","sharedFiles","moreResults","refresh","_loadResults","offset","route","params","reject","page","find","parseResults","_loadMore","_callee2","_context2","_results$payload","payload","links","_this$files","unshift","removeFromList","hasFiles","empty","FileManagerModal","multiSelect","dragDrop","selectedFilesLibrary","defaultFilesLibrary","sharedUploads","userFileState","sharedFileState","onUpload","onremove","_app$session$user","fileCount","_this$attrs","hideUser","hideShared","uploadSharedFiles","showUploadModal","accessSharedFiles","fileLibraryButtonItems","alertAttrs","userFilesContent","sharedFilesContent","onSelect","setLibrary","library","itemPosition","_this4","fileId","getById","editor","insertAtCursor","bbcode","_this5","FileManagerButton","fileManagerButtonClicked","File","_Model","Model","path","humanSize","createdAt","tag","isPrivateShared","apiEndpoint","exists","Extend","UploadsUserPage","_UserPage","loadUser","param","viewOthersMediaLibrary","component","UserPage","extend","_extends","assign","components","UploadedFile","statusIcon","hideFileIcon","User","deleteOthersMediaLibrary","uploadCountCurrent","uploadCountAll","TextEditor","composerButtonVisiblity","f_","composer","preview","originalIsFullScreen","isFullScreen","dragAndDropTarget","fofUploadDragAndDropTarget","dragAndDrop","parents","Post","unbind","encodeURIComponent","currentTarget","dataset","fofUploadDownloadUuid","post","csrfToken","alert","canUpload","hasUploads","uploadCount","LinkButton","href","username","slug"],"sourceRoot":""}