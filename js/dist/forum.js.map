{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@fof/upload/./node_modules/@babel/runtime/helpers/regeneratorRuntime.js","webpack://@fof/upload/./node_modules/@babel/runtime/helpers/typeof.js","webpack://@fof/upload/./node_modules/@babel/runtime/regenerator/index.js","webpack://@fof/upload/webpack/bootstrap","webpack://@fof/upload/webpack/runtime/compat get default export","webpack://@fof/upload/webpack/runtime/define property getters","webpack://@fof/upload/webpack/runtime/hasOwnProperty shorthand","webpack://@fof/upload/webpack/runtime/make namespace object","webpack://@fof/upload/external root \"flarum.core.compat['forum/app']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/models/User']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/Model']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/extend']\"","webpack://@fof/upload/external root \"flarum.core.compat['forum/components/Post']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/components/TextEditor']\"","webpack://@fof/upload/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@fof/upload/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/upload/external root \"flarum.core.compat['common/Component']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/components/Button']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/utils/classList']\"","webpack://@fof/upload/./src/forum/components/UploadButton.js","webpack://@fof/upload/./src/forum/components/DragAndDrop.js","webpack://@fof/upload/./src/forum/components/PasteClipboard.js","webpack://@fof/upload/./src/forum/handler/Uploader.js","webpack://@fof/upload/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/app']\"","webpack://@fof/upload/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://@fof/upload/./src/common/mimeToIcon.ts","webpack://@fof/upload/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/components/Tooltip']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@fof/upload/./src/common/components/DisplayFile.tsx","webpack://@fof/upload/external root \"flarum.core.compat['common/components/Alert']\"","webpack://@fof/upload/./src/common/components/AbstractFIleList.tsx","webpack://@fof/upload/./src/common/components/UserFileList.tsx","webpack://@fof/upload/external root \"flarum.core.compat['common/components/Switch']\"","webpack://@fof/upload/./src/common/components/UploadSharedFileModal.tsx","webpack://@fof/upload/./src/common/components/SharedFileList.tsx","webpack://@fof/upload/./src/common/states/FileListState.ts","webpack://@fof/upload/./src/forum/components/FileManagerModal.js","webpack://@fof/upload/./src/forum/components/FileManagerButton.tsx","webpack://@fof/upload/external root \"flarum.core.compat['forum/components/UserPage']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@fof/upload/external root \"flarum.core.compat['common/extenders']\"","webpack://@fof/upload/./src/common/models/File.ts","webpack://@fof/upload/./src/common/extend.ts","webpack://@fof/upload/./src/forum/components/UploadsUserPage.tsx","webpack://@fof/upload/./src/forum/extend.ts","webpack://@fof/upload/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@fof/upload/./src/common/components/UploadedFile.tsx","webpack://@fof/upload/./src/forum/components/index.ts","webpack://@fof/upload/./src/common/components/index.ts","webpack://@fof/upload/./src/forum/index.js","webpack://@fof/upload/./src/forum/addUploadButton.js","webpack://@fof/upload/./src/forum/downloadButtonInteraction.js","webpack://@fof/upload/./src/forum/addUserPageButton.js"],"sourcesContent":["var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction _regeneratorRuntime() {\n  \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */\n  module.exports = _regeneratorRuntime = function _regeneratorRuntime() {\n    return e;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  var t,\n    e = {},\n    r = Object.prototype,\n    n = r.hasOwnProperty,\n    o = Object.defineProperty || function (t, e, r) {\n      t[e] = r.value;\n    },\n    i = \"function\" == typeof Symbol ? Symbol : {},\n    a = i.iterator || \"@@iterator\",\n    c = i.asyncIterator || \"@@asyncIterator\",\n    u = i.toStringTag || \"@@toStringTag\";\n  function define(t, e, r) {\n    return Object.defineProperty(t, e, {\n      value: r,\n      enumerable: !0,\n      configurable: !0,\n      writable: !0\n    }), t[e];\n  }\n  try {\n    define({}, \"\");\n  } catch (t) {\n    define = function define(t, e, r) {\n      return t[e] = r;\n    };\n  }\n  function wrap(t, e, r, n) {\n    var i = e && e.prototype instanceof Generator ? e : Generator,\n      a = Object.create(i.prototype),\n      c = new Context(n || []);\n    return o(a, \"_invoke\", {\n      value: makeInvokeMethod(t, r, c)\n    }), a;\n  }\n  function tryCatch(t, e, r) {\n    try {\n      return {\n        type: \"normal\",\n        arg: t.call(e, r)\n      };\n    } catch (t) {\n      return {\n        type: \"throw\",\n        arg: t\n      };\n    }\n  }\n  e.wrap = wrap;\n  var h = \"suspendedStart\",\n    l = \"suspendedYield\",\n    f = \"executing\",\n    s = \"completed\",\n    y = {};\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n  var p = {};\n  define(p, a, function () {\n    return this;\n  });\n  var d = Object.getPrototypeOf,\n    v = d && d(d(values([])));\n  v && v !== r && n.call(v, a) && (p = v);\n  var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p);\n  function defineIteratorMethods(t) {\n    [\"next\", \"throw\", \"return\"].forEach(function (e) {\n      define(t, e, function (t) {\n        return this._invoke(e, t);\n      });\n    });\n  }\n  function AsyncIterator(t, e) {\n    function invoke(r, o, i, a) {\n      var c = tryCatch(t[r], t, o);\n      if (\"throw\" !== c.type) {\n        var u = c.arg,\n          h = u.value;\n        return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) {\n          invoke(\"next\", t, i, a);\n        }, function (t) {\n          invoke(\"throw\", t, i, a);\n        }) : e.resolve(h).then(function (t) {\n          u.value = t, i(u);\n        }, function (t) {\n          return invoke(\"throw\", t, i, a);\n        });\n      }\n      a(c.arg);\n    }\n    var r;\n    o(this, \"_invoke\", {\n      value: function value(t, n) {\n        function callInvokeWithMethodAndArg() {\n          return new e(function (e, r) {\n            invoke(t, n, e, r);\n          });\n        }\n        return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();\n      }\n    });\n  }\n  function makeInvokeMethod(e, r, n) {\n    var o = h;\n    return function (i, a) {\n      if (o === f) throw Error(\"Generator is already running\");\n      if (o === s) {\n        if (\"throw\" === i) throw a;\n        return {\n          value: t,\n          done: !0\n        };\n      }\n      for (n.method = i, n.arg = a;;) {\n        var c = n.delegate;\n        if (c) {\n          var u = maybeInvokeDelegate(c, n);\n          if (u) {\n            if (u === y) continue;\n            return u;\n          }\n        }\n        if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) {\n          if (o === h) throw o = s, n.arg;\n          n.dispatchException(n.arg);\n        } else \"return\" === n.method && n.abrupt(\"return\", n.arg);\n        o = f;\n        var p = tryCatch(e, r, n);\n        if (\"normal\" === p.type) {\n          if (o = n.done ? s : l, p.arg === y) continue;\n          return {\n            value: p.arg,\n            done: n.done\n          };\n        }\n        \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg);\n      }\n    };\n  }\n  function maybeInvokeDelegate(e, r) {\n    var n = r.method,\n      o = e.iterator[n];\n    if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y;\n    var i = tryCatch(o, e.iterator, r.arg);\n    if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y;\n    var a = i.arg;\n    return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y);\n  }\n  function pushTryEntry(t) {\n    var e = {\n      tryLoc: t[0]\n    };\n    1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e);\n  }\n  function resetTryEntry(t) {\n    var e = t.completion || {};\n    e.type = \"normal\", delete e.arg, t.completion = e;\n  }\n  function Context(t) {\n    this.tryEntries = [{\n      tryLoc: \"root\"\n    }], t.forEach(pushTryEntry, this), this.reset(!0);\n  }\n  function values(e) {\n    if (e || \"\" === e) {\n      var r = e[a];\n      if (r) return r.call(e);\n      if (\"function\" == typeof e.next) return e;\n      if (!isNaN(e.length)) {\n        var o = -1,\n          i = function next() {\n            for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next;\n            return next.value = t, next.done = !0, next;\n          };\n        return i.next = i;\n      }\n    }\n    throw new TypeError(_typeof(e) + \" is not iterable\");\n  }\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", {\n    value: GeneratorFunctionPrototype,\n    configurable: !0\n  }), o(GeneratorFunctionPrototype, \"constructor\", {\n    value: GeneratorFunction,\n    configurable: !0\n  }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) {\n    var e = \"function\" == typeof t && t.constructor;\n    return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name));\n  }, e.mark = function (t) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t;\n  }, e.awrap = function (t) {\n    return {\n      __await: t\n    };\n  }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () {\n    return this;\n  }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) {\n    void 0 === i && (i = Promise);\n    var a = new AsyncIterator(wrap(t, r, n, o), i);\n    return e.isGeneratorFunction(r) ? a : a.next().then(function (t) {\n      return t.done ? t.value : a.next();\n    });\n  }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () {\n    return this;\n  }), define(g, \"toString\", function () {\n    return \"[object Generator]\";\n  }), e.keys = function (t) {\n    var e = Object(t),\n      r = [];\n    for (var n in e) r.push(n);\n    return r.reverse(), function next() {\n      for (; r.length;) {\n        var t = r.pop();\n        if (t in e) return next.value = t, next.done = !1, next;\n      }\n      return next.done = !0, next;\n    };\n  }, e.values = values, Context.prototype = {\n    constructor: Context,\n    reset: function reset(e) {\n      if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t);\n    },\n    stop: function stop() {\n      this.done = !0;\n      var t = this.tryEntries[0].completion;\n      if (\"throw\" === t.type) throw t.arg;\n      return this.rval;\n    },\n    dispatchException: function dispatchException(e) {\n      if (this.done) throw e;\n      var r = this;\n      function handle(n, o) {\n        return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o;\n      }\n      for (var o = this.tryEntries.length - 1; o >= 0; --o) {\n        var i = this.tryEntries[o],\n          a = i.completion;\n        if (\"root\" === i.tryLoc) return handle(\"end\");\n        if (i.tryLoc <= this.prev) {\n          var c = n.call(i, \"catchLoc\"),\n            u = n.call(i, \"finallyLoc\");\n          if (c && u) {\n            if (this.prev < i.catchLoc) return handle(i.catchLoc, !0);\n            if (this.prev < i.finallyLoc) return handle(i.finallyLoc);\n          } else if (c) {\n            if (this.prev < i.catchLoc) return handle(i.catchLoc, !0);\n          } else {\n            if (!u) throw Error(\"try statement without catch or finally\");\n            if (this.prev < i.finallyLoc) return handle(i.finallyLoc);\n          }\n        }\n      }\n    },\n    abrupt: function abrupt(t, e) {\n      for (var r = this.tryEntries.length - 1; r >= 0; --r) {\n        var o = this.tryEntries[r];\n        if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) {\n          var i = o;\n          break;\n        }\n      }\n      i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null);\n      var a = i ? i.completion : {};\n      return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a);\n    },\n    complete: function complete(t, e) {\n      if (\"throw\" === t.type) throw t.arg;\n      return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y;\n    },\n    finish: function finish(t) {\n      for (var e = this.tryEntries.length - 1; e >= 0; --e) {\n        var r = this.tryEntries[e];\n        if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y;\n      }\n    },\n    \"catch\": function _catch(t) {\n      for (var e = this.tryEntries.length - 1; e >= 0; --e) {\n        var r = this.tryEntries[e];\n        if (r.tryLoc === t) {\n          var n = r.completion;\n          if (\"throw\" === n.type) {\n            var o = n.arg;\n            resetTryEntry(r);\n          }\n          return o;\n        }\n      }\n      throw Error(\"illegal catch attempt\");\n    },\n    delegateYield: function delegateYield(e, r, n) {\n      return this.delegate = {\n        iterator: values(e),\n        resultName: r,\n        nextLoc: n\n      }, \"next\" === this.method && (this.arg = t), y;\n    }\n  }, e;\n}\nmodule.exports = _regeneratorRuntime, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _typeof(o);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// TODO(Babel 8): Remove this file.\n\nvar runtime = require(\"../helpers/regeneratorRuntime\")();\nmodule.exports = runtime;\n\n// Copied from https://github.com/facebook/regenerator/blob/main/packages/runtime/runtime.js#L736=\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/User'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/Post'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/TextEditor'];","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/classList'];","import app from 'flarum/forum/app';\nimport Component from 'flarum/common/Component';\nimport Button from 'flarum/common/components/Button';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport classList from 'flarum/common/utils/classList';\n\nexport default class UploadButton extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.attrs.uploader.on('uploaded', () => {\n      // reset the button for a new upload\n      this.$('form')[0].reset();\n\n      // redraw to reflect uploader.loading in the DOM\n      m.redraw();\n    });\n\n    this.isMediaUploadButton = vnode.attrs.isMediaUploadButton || false;\n  }\n\n  view() {\n    const buttonText = this.attrs.uploader.uploading\n      ? app.translator.trans('fof-upload.forum.states.loading')\n      : app.translator.trans('fof-upload.forum.buttons.upload');\n\n    return (\n      <Button\n        className={classList([\n          'Button',\n          'hasIcon',\n          'fof-upload-button',\n          !this.isMediaUploadButton && !this.attrs.uploader.uploading && 'Button--icon',\n          !this.isMediaUploadButton && !this.attrs.uploader.uploading && 'Button--link',\n          this.attrs.uploader.uploading && 'uploading',\n        ])}\n        icon={!this.attrs.uploader.uploading && 'fas fa-file-upload'}\n        onclick={this.uploadButtonClicked.bind(this)}\n        disabled={this.attrs.disabled}\n      >\n        {this.attrs.uploader.uploading && <LoadingIndicator size=\"small\" display=\"inline\" className=\"Button-icon\" />}\n        {(this.isMediaUploadButton || this.attrs.uploader.uploading) && <span className=\"Button-label\">{buttonText}</span>}\n        <form>\n          <input type=\"file\" multiple={true} onchange={this.process.bind(this)} />\n        </form>\n      </Button>\n    );\n  }\n\n  /**\n   * Process the upload event.\n   *\n   * @param e\n   */\n  process(e) {\n    // get the file from the input field\n    const files = this.$('input').prop('files');\n\n    if (files.length === 0) {\n      // We've got no files to upload, so trying\n      // to begin an upload will show an error\n      // to the user.\n      return;\n    }\n\n    this.attrs.uploader.upload(files, !this.isMediaUploadButton);\n  }\n\n  /**\n   * Event handler for upload button being clicked\n   *\n   * @param {PointerEvent} e\n   */\n  uploadButtonClicked(e) {\n    // Trigger click on hidden input element\n    // (Opens file dialog)\n    this.$('input').click();\n  }\n}\n","export default class DragAndDrop {\n  constructor(upload, composerElement) {\n    this.upload = upload;\n    this.composerElement = composerElement;\n\n    // Keep references to the bound methods so we can remove the event listeners later\n    this.handlers = {};\n\n    if (!this.supportsFileDragging()) {\n      return;\n    }\n\n    this.composerElement.addEventListener('dragover', (this.handlers.in = this.in.bind(this)));\n\n    this.composerElement.addEventListener('dragleave', (this.handlers.out = this.out.bind(this)));\n    this.composerElement.addEventListener('dragend', this.handlers.out);\n\n    this.composerElement.addEventListener('drop', (this.handlers.dropping = this.dropping.bind(this)));\n  }\n\n  supportsFileDragging() {\n    // Based on https://css-tricks.com/drag-and-drop-file-uploading/\n    const div = document.createElement('div');\n\n    return ('draggable' in div || ('ondragstart' in div && 'ondrop' in div)) && 'FormData' in window && 'FileReader' in window;\n  }\n\n  unload() {\n    // If the handlers were not set (drag and drop not supported), we skip removing them\n    if (!this.handlers.in) {\n      return;\n    }\n\n    this.composerElement.removeEventListener('dragover', this.handlers.in);\n\n    this.composerElement.removeEventListener('dragleave', this.handlers.out);\n    this.composerElement.removeEventListener('dragend', this.handlers.out);\n\n    this.composerElement.removeEventListener('drop', this.handlers.dropping);\n  }\n\n  isNotFile(event) {\n    // Checking event.dataTransfer.files.length does not work on dragover event, it's always zero\n    // So we use the dataTransfer.items property to check whether any file is being dragged\n    if (event.dataTransfer.items) {\n      for (let i = 0; i < event.dataTransfer.items.length; i++) {\n        if (event.dataTransfer.items[i].kind !== 'file') {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  in(event) {\n    if (this.isNotFile(event)) {\n      return;\n    }\n\n    event.preventDefault();\n\n    if (!this.over) {\n      this.composerElement.classList.add('fof-upload-dragging');\n      this.over = true;\n    }\n  }\n\n  out(event) {\n    if (this.isNotFile(event)) {\n      return;\n    }\n\n    event.preventDefault();\n\n    if (this.over) {\n      this.composerElement.classList.remove('fof-upload-dragging');\n      this.over = false;\n    }\n  }\n\n  dropping(event) {\n    if (this.isNotFile(event)) {\n      return;\n    }\n\n    event.preventDefault();\n\n    this.upload(event.dataTransfer.files);\n\n    this.composerElement.classList.remove('fof-upload-dragging');\n  }\n}\n","export default class PasteClipboard {\n  constructor(upload, element) {\n    this.upload = upload;\n\n    // We don't need to remove the events listeners, because they'll get removed when the DOM does.\n    element.addEventListener('paste', this.paste.bind(this));\n  }\n\n  paste(e) {\n    if (e.clipboardData && e.clipboardData.items) {\n      const items = e.clipboardData.items;\n\n      const files = [];\n\n      for (let i = 0; i < items.length; i++) {\n        if (items[i].type.indexOf('image') !== -1) {\n          files.push(items[i].getAsFile());\n        }\n      }\n\n      if (files.length > 0) {\n        e.preventDefault();\n\n        this.upload(files);\n      }\n    }\n  }\n}\n","import app from 'flarum/forum/app';\n\nexport default class Uploader {\n  constructor() {\n    this.callbacks = {\n      success: [],\n      failure: [],\n      uploading: [],\n      uploaded: [],\n    };\n    this.uploading = false;\n  }\n\n  setState(fileState) {\n    this.fileState = fileState;\n  }\n\n  on(type, callback) {\n    this.callbacks[type].push(callback);\n  }\n\n  dispatch(type, response) {\n    this.callbacks[type].forEach((callback) => callback(response));\n  }\n\n  upload(files, addBBcode = true) {\n    this.uploading = true;\n    this.dispatch('uploading', files);\n\n    m.redraw(); // Forcing a redraw so that the button also updates if uploadFiles() is called from DragAndDrop or PasteClipboard\n\n    const body = new FormData();\n\n    for (let i = 0; i < files.length; i++) {\n      body.append('files[]', files[i]);\n    }\n\n    // send a POST request to the api\n    return app\n      .request({\n        method: 'POST',\n        url: app.forum.attribute('apiUrl') + '/fof/upload',\n        // prevent JSON.stringify'ing the form data in the XHR call\n        serialize: (raw) => raw,\n        body,\n      })\n      .then((result) => this.uploaded(result, addBBcode))\n      .catch((error) => {\n        this.uploading = false;\n        m.redraw();\n\n        const e = error.response.errors[0];\n\n        if (!e.code.includes('fof-upload')) {\n          throw error;\n        }\n\n        app.alerts.clear();\n        app.alerts.show(\n          {\n            type: 'error',\n          },\n          e.detail\n        );\n      });\n  }\n\n  uploaded(result, addBBcode = false) {\n    this.uploading = false;\n\n    result.data.forEach((file) => {\n      const fileObj = app.store.pushObject(file);\n\n      // Add file to media manager\n      this.fileState?.addToList(fileObj);\n\n      // Dispatch\n      this.dispatch('success', {\n        file: fileObj,\n        addBBcode,\n      });\n    });\n\n    this.dispatch('uploaded');\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/app'];","function asyncGeneratorStep(n, t, e, r, o, a, c) {\n  try {\n    var i = n[a](c),\n      u = i.value;\n  } catch (n) {\n    return void e(n);\n  }\n  i.done ? t(u) : Promise.resolve(u).then(r, o);\n}\nfunction _asyncToGenerator(n) {\n  return function () {\n    var t = this,\n      e = arguments;\n    return new Promise(function (r, o) {\n      var a = n.apply(t, e);\n      function _next(n) {\n        asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n);\n      }\n      function _throw(n) {\n        asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n);\n      }\n      _next(void 0);\n    });\n  };\n}\nexport { _asyncToGenerator as default };","const mimeToIconMap = new Map<string, string>([\n  // Image formats\n  ['image/png', 'far fa-file-image'],\n  ['image/jpg', 'far fa-file-image'],\n  ['image/jpeg', 'far fa-file-image'],\n  ['image/svg+xml', 'far fa-file-image'],\n  ['image/gif', 'far fa-file-image'],\n  ['image/bmp', 'far fa-file-image'],\n  ['image/webp', 'far fa-file-image'],\n\n  // Compressed file formats\n  ['application/zip', 'far fa-file-archive'],\n  ['application/x-7z-compressed', 'far fa-file-archive'],\n  ['application/gzip', 'far fa-file-archive'],\n  ['application/vnd.rar', 'far fa-file-archive'],\n  ['application/x-rar-compressed', 'far fa-file-archive'],\n  ['application/x-tar', 'far fa-file-archive'],\n  ['application/x-iso9660-image', 'far fa-file-archive'],\n\n  // Text and code file formats\n  ['text/plain', 'far fa-file-alt'],\n  ['text/csv', 'far fa-file-csv'],\n  ['text/xml', 'far fa-file-code'],\n  ['text/html', 'far fa-file-code'],\n  ['text/css', 'far fa-file-code'],\n  ['text/javascript', 'far fa-file-code'],\n  ['application/json', 'far fa-file-code'],\n  ['application/ld+json', 'far fa-file-code'],\n  ['application/x-httpd-php', 'far fa-file-code'],\n  ['application/xml', 'far fa-file-code'],\n  ['text/xml', 'far fa-file-code'],\n\n  // Document formats\n  ['application/x-abiword', 'far fa-file-word'],\n  ['application/msword', 'far fa-file-word'],\n  ['application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'far fa-file-word'],\n  ['application/vnd.oasis.opendocument.text', 'far fa-file-word'],\n  ['application/vnd.ms-excel', 'far fa-file-excel'],\n  ['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'far fa-file-excel'],\n  ['application/vnd.oasis.opendocument.spreadsheet', 'far fa-file-excel'],\n  ['application/vnd.ms-powerpoint', 'far fa-file-powerpoint'],\n  ['application/vnd.openxmlformats-officedocument.presentationml.presentation', 'far fa-file-powerpoint'],\n  ['application/vnd.oasis.opendocument.presentation', 'far fa-file-powerpoint'],\n  ['application/pdf', 'far fa-file-pdf'],\n  ['application/rtf', 'far fa-file-alt'],\n\n  // eBook formats\n  ['application/epub+zip', 'far fa-book'],\n  ['application/x-mobipocket-ebook', 'far fa-book'],\n  ['application/vnd.amazon.ebook', 'far fa-book'],\n\n  // Audio formats\n  ['audio/mpeg', 'far fa-file-audio'],\n  ['audio/wav', 'far fa-file-audio'],\n  ['audio/x-wav', 'far fa-file-audio'],\n  ['audio/aac', 'far fa-file-audio'],\n  ['audio/ogg', 'far fa-file-audio'],\n  ['audio/flac', 'far fa-file-audio'],\n  ['audio/aiff', 'far fa-file-audio'],\n  ['audio/x-aiff', 'far fa-file-audio'],\n\n  // Video formats\n  ['video/x-msvideo', 'far fa-file-video'],\n  ['video/mp4', 'far fa-file-video'],\n  ['video/quicktime', 'far fa-file-video'],\n]);\n\nexport default function mimeToIcon(fileType: string): string {\n  // Directly return the icon if the fileType is in the map\n  return (\n    mimeToIconMap.get(fileType) ||\n    (function () {\n      // Check for generic types\n      if (fileType.startsWith('image/')) {\n        return 'far fa-file-image';\n      } else if (fileType.startsWith('video/')) {\n        return 'far fa-file-video';\n      } else if (fileType.startsWith('audio/')) {\n        return 'far fa-file-audio';\n      }\n\n      // Default icon\n      return 'far fa-file';\n    })()\n  );\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Tooltip'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","import app from 'flarum/common/app';\nimport Component, { ComponentAttrs } from 'flarum/common/Component';\nimport File from '../models/File';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport Button from 'flarum/common/components/Button';\nimport icon from 'flarum/common/helpers/icon';\nimport mimeToIcon from '../mimeToIcon';\nimport User from 'flarum/common/models/User';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport type Mithril from 'mithril';\nimport Tooltip from 'flarum/common/components/Tooltip';\nimport extractText from 'flarum/common/utils/extractText';\n\ninterface CustomAttrs extends ComponentAttrs {\n  file: File;\n  fileSelectable: boolean;\n  isSelected: boolean;\n  fileClassNames: string;\n  isFileHiding: boolean;\n  onHide: (file: File) => void | undefined;\n  onFileClick: (file: File) => void | undefined;\n  onDelete: (file: File) => void | undefined;\n  user: User;\n}\n\nexport default class DisplayFile extends Component<CustomAttrs> {\n  isFileHiding!: boolean;\n  imageLoaded: boolean = true;\n  file!: File;\n  fileIcon!: string;\n  isSelected!: boolean;\n  isSelectable!: boolean;\n\n  oninit(vnode: Mithril.Vnode<CustomAttrs, this>) {\n    super.oninit(vnode);\n\n    this.file = this.attrs.file;\n    this.isFileHiding = this.attrs.isFileHiding === undefined ? false : this.attrs.isFileHiding;\n    this.fileIcon = mimeToIcon(this.file.type());\n    this.isSelected = this.attrs.isSelected === undefined ? false : this.attrs.isSelected;\n    this.isSelectable = this.attrs.fileSelectable === undefined ? true : this.attrs.fileSelectable;\n  }\n\n  onbeforeupdate(vnode: Mithril.VnodeDOM<CustomAttrs, this>): void {\n    super.onbeforeupdate(vnode);\n\n    // Make sure the isSelected property is updated\n    this.isSelected = this.attrs.isSelected === undefined ? false : this.attrs.isSelected;\n  }\n\n  view() {\n    const isImage = this.file.type().startsWith('image/');\n\n    const fileSelectedClass = this.isSelected ? 'selected' : '';\n\n    return (\n      <div\n        className={`UploadedFile ${fileSelectedClass}`}\n        key={this.file.uuid()}\n        onclick={() => {\n          if (this.isSelectable && !this.isFileHiding) {\n            this.isSelected = !this.isSelected;\n            this.attrs.onFileClick(this.file);\n          }\n        }}\n        disabled={!this.isSelectable || this.isFileHiding}\n      >\n        {this.imageLoaded && isImage ? (\n          <img\n            src={this.file.url()}\n            className=\"fof-file-image-preview\"\n            draggable={false}\n            onerror={this.handleImageError}\n            onload={this.handleImageLoad}\n            alt={this.file.baseName()}\n          />\n        ) : (\n          this.displayIcon(this.fileIcon)\n        )}\n\n        <div className=\"fof-file-actions\">{this.actionItems(this.file).toArray()}</div>\n\n        <div className=\"fof-file-name\">\n          <Tooltip text={this.file.baseName()}>\n            <span>{this.file.baseName()}</span>\n          </Tooltip>\n        </div>\n\n        {this.isFileHiding && (\n          <div class=\"fof-file-loading\" role=\"status\" aria-label={app.translator.trans('fof-upload.lib.file_list.hide_file.loading')}>\n            <LoadingIndicator />\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  displayIcon(fileIcon: string): Mithril.Children {\n    return (\n      <span\n        className=\"fof-file-icon\"\n        role=\"presentation\"\n        style={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          height: '100%', // Ensure the container takes up the necessary space\n        }}\n      >\n        {icon(`fa-fw ${fileIcon}`)}\n      </span>\n    );\n  }\n\n  actionItems(file: File): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    file.canViewInfo() &&\n      items.add(\n        'view-info',\n        <Button className=\"Button Button--icon fof-file-action\" icon=\"fas fa-info-circle\" aria-label=\"info\" onclick={() => this.viewFileInfo()} />,\n        100\n      );\n\n    const transPrefix = file.isShared() ? 'fof-upload.lib.file_list.hide_shared_file' : 'fof-upload.lib.file_list.hide_file';\n    const hideTranslation = app.translator.trans(this.file.hidden() ? `${transPrefix}.btn_a11y_label_show` : `${transPrefix}.btn_a11y_label_hide`, {\n      fileName: file.baseName(),\n    });\n\n    file.canHide() &&\n      items.add(\n        'hide-file',\n        <Tooltip text={hideTranslation} position=\"bottom\">\n          <Button\n            className=\"Button Button--icon fof-file-action\"\n            icon={this.file.hidden() ? 'fas fa-eye' : 'fas fa-eye-slash'}\n            aria-label={hideTranslation}\n            disabled={this.isFileHiding}\n            onclick={(e: Event) => this.hide(e)}\n          />\n        </Tooltip>,\n        80\n      );\n\n    const deleteTranslation = app.translator.trans('fof-upload.lib.file_list.delete_file_a11y_label', { fileName: file.baseName() });\n\n    file.canDelete() &&\n      items.add(\n        'delete-file',\n        <Tooltip text={deleteTranslation} position=\"bottom\">\n          <Button\n            className=\"Button Button--icon fof-file-action\"\n            icon=\"fas fa-trash\"\n            aria-label={deleteTranslation}\n            disabled={this.isFileHiding}\n            onclick={(e: MouseEvent) => this.confirmDelete(e)}\n          />\n        </Tooltip>,\n        60\n      );\n\n    return items;\n  }\n\n  // Function to call when image fails to load\n  handleImageError = () => {\n    this.imageLoaded = false;\n    this.fileIcon = 'fas fa-exclamation-triangle';\n    this.isSelectable = false;\n    m.redraw();\n  };\n\n  // Function to call when image loads successfully\n  handleImageLoad = () => {\n    this.imageLoaded = true;\n    m.redraw();\n  };\n\n  viewFileInfo() {\n    console.log('view file info');\n  }\n\n  hide(e: Event) {\n    e.stopPropagation();\n\n    // TODO: local logic, then:\n\n    if (this.attrs.onHide) {\n      this.attrs.onHide(this.file);\n    }\n  }\n\n  async confirmDelete(e: MouseEvent) {\n    e.stopPropagation();\n\n    if (confirm(extractText(app.translator.trans('fof-upload.lib.file_list.delete_confirmation', { fileName: this.file.baseName() })))) {\n      const uuid = this.file.uuid();\n      await app.request({\n        method: 'DELETE',\n        url: app.forum.attribute('apiUrl') + '/fof/upload/delete/' + uuid,\n      });\n\n      if (this.attrs.onDelete) {\n        this.attrs.onDelete(this.file);\n      }\n    }\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Alert'];","import app from 'flarum/common/app';\nimport Component, { ComponentAttrs } from 'flarum/common/Component';\nimport File from '../models/File';\nimport type Mithril from 'mithril';\nimport User from 'flarum/common/models/User';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport mimeToIcon from '../mimeToIcon';\nimport classList from 'flarum/common/utils/classList';\nimport Button from 'flarum/common/components/Button';\nimport DisplayFile from './DisplayFile';\nimport Alert from 'flarum/common/components/Alert';\nimport extractText from 'flarum/common/utils/extractText';\nimport FileListState from '../states/FileListState';\nimport { ApiPayloadSingle } from 'flarum/common/Store';\nimport icon from 'flarum/common/helpers/icon';\n\nexport interface FileListAttrs extends ComponentAttrs {\n  user: User | null;\n  selectable: boolean;\n  restrictFileType: string | string[];\n  selectedFiles: string[];\n  downloadOnClick: boolean;\n  onFileSelect: (file: File) => void | undefined;\n  onDelete: (file: File) => void | undefined;\n  fileState: FileListState;\n}\n\nexport default abstract class AbstractFileList extends Component<FileListAttrs> {\n  user: User | null = null;\n  inModal!: boolean;\n  restrictFileType!: string | string[] | null;\n  downloadOnClick!: boolean;\n  filesBeingHidden!: string[];\n  fileState!: FileListState;\n\n  public abstract loadFileList(): void;\n  abstract hasMoreResults(): boolean;\n  abstract loadMore(): void;\n  abstract isLoading(): boolean;\n  abstract fileCollection(): File[];\n\n  oninit(vnode: Mithril.Vnode<FileListAttrs, this>) {\n    super.oninit(vnode);\n\n    this.inModal = this.attrs.selectable;\n    this.restrictFileType = this.attrs.restrictFileType || null;\n    this.downloadOnClick = this.attrs.downloadOnClick || false;\n    this.filesBeingHidden = [];\n    this.fileState = this.attrs.fileState;\n\n    this.loadFileList();\n  }\n\n  view() {\n    return (\n      <div className=\"SharedFileList fof-upload-file-list\" aria-live=\"polite\">\n        {/* Loading */}\n        {this.isLoading() && this.fileCollection().length === 0 && (\n          <div className={'fof-upload-loading'}>\n            {app.translator.trans('fof-upload.lib.file_list.loading')}\n\n            <LoadingIndicator />\n          </div>\n        )}\n        {/* Empty file list */}\n        {!this.isLoading() && this.fileCollection().length === 0 && (\n          <div className=\"Placeholder\">\n            <p className=\"fof-upload-empty\">{app.translator.trans('fof-upload.lib.file_list.empty')}</p>\n          </div>\n        )}\n        {/* File list */}\n        <ul>\n          {this.fileCollection().map((file: File) => {\n            const fileIcon = mimeToIcon(file.type());\n            const fileSelectable = this.restrictFileType ? this.isSelectable(file) : true;\n\n            const fileClassNames = classList([\n              'fof-file',\n              // File is image\n              fileIcon === 'far fa-file-image' && 'fof-file-type-image',\n              // File is selected\n              this.attrs.selectedFiles && this.attrs.selectedFiles.indexOf(file.id() ?? '') >= 0 && 'fof-file-selected',\n            ]);\n\n            const isFileHiding = this.filesBeingHidden.includes(file.uuid());\n\n            return (\n              <li aria-busy={isFileHiding} key={file.uuid()}>\n                <DisplayFile\n                  file={file}\n                  fileSelectable={fileSelectable}\n                  isSelected={this.attrs.selectedFiles && this.attrs.selectedFiles.indexOf(file.id() ?? '') >= 0}\n                  fileClassNames={fileClassNames}\n                  isFileHiding={isFileHiding}\n                  onHide={this.hideFile.bind(this)}\n                  onFileClick={this.onFileClick.bind(this)}\n                  user={this.attrs.user}\n                  onDelete={this.onDelete.bind(this)}\n                />\n              </li>\n            );\n          })}\n        </ul>\n        {/* Load more files */}\n        {this.hasMoreResults() && (\n          <div className={'fof-load-more-files'}>\n            <Button className={'Button Button--primary'} disabled={this.isLoading()} loading={this.isLoading()} onclick={() => this.loadMore()}>\n              {app.translator.trans('fof-upload.lib.file_list.load_more_files_btn')}\n            </Button>\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  onDelete(file: File) {\n    if (this.attrs.onDelete) {\n      this.attrs.onDelete(file);\n    }\n  }\n\n  // Common methods like onFileClick, isSelectable, hideFile...\n\n  onFileClick(file: File) {\n    // Custom functionality\n    if (this.attrs.onFileSelect) {\n      this.attrs.onFileSelect(file);\n      return;\n    }\n\n    // Download on click\n    if (this.attrs.downloadOnClick) {\n      window.open(file.url());\n      return;\n    }\n  }\n\n  isSelectable(file: File) {\n    const fileType = file.type();\n\n    // Custom defined file types\n    if (Array.isArray(this.restrictFileType)) {\n      return this.restrictFileType.indexOf(fileType) >= 0;\n    }\n\n    // Image\n    else if (this.restrictFileType === 'image') {\n      return fileType.includes('image/');\n    }\n\n    // Audio\n    else if (this.restrictFileType === 'audio') {\n      return fileType.includes('audio/');\n    }\n\n    // Video\n    else if (this.restrictFileType === 'video') {\n      return fileType.includes('video/');\n    }\n\n    return false;\n  }\n\n  /**\n   * Begins the hiding process for a file.\n   *\n   * - Shows a native confirmation dialog\n   * - If confirmed, sends AJAX request to the hide file API\n   */\n  async hideFile(file: File) {\n    const uuid = file.uuid();\n\n    if (this.filesBeingHidden.includes(uuid)) return;\n\n    this.filesBeingHidden.push(uuid);\n\n    const transPrefix = file.isShared() ? 'fof-upload.lib.file_list.hide_shared_file' : 'fof-upload.lib.file_list.hide_file';\n\n    const confirmToggleHide = confirm(\n      extractText(\n        app.translator.trans(file.hidden() ? `${transPrefix}.show_confirmation` : `${transPrefix}.hide_confirmation`, {\n          fileName: file.baseName(),\n        })\n      )\n    );\n\n    if (confirmToggleHide) {\n      try {\n        const filePayload = await app.request<ApiPayloadSingle>({\n          method: 'PATCH',\n          url: `${app.forum.attribute('apiUrl')}/fof/upload/hide`,\n          body: { uuid },\n        });\n\n        app.store.pushPayload(filePayload);\n        m.redraw();\n\n        app.alerts.show(Alert, { type: 'success' }, [\n          icon(file.hidden() ? 'fas fa-eye-slash' : 'fas fa-eye'),\n          ' ',\n          app.translator.trans(file?.hidden() ? `${transPrefix}.hide_success` : `${transPrefix}.show_success`),\n        ]);\n\n        if (this.fileState.user) {\n          const index = this.fileState.files.findIndex((file: File) => uuid === file.uuid());\n          this.fileState.files.splice(index, 1);\n        }\n      } catch (error) {\n        app.alerts.show(\n          Alert,\n          { type: 'error' },\n          app.translator.trans(file?.hidden() ? `${transPrefix}.hide_fail` : `${transPrefix}.show_fail`, {\n            fileName: file.baseName(),\n          })\n        );\n      } finally {\n        // Remove file from hiding list\n        const i = this.filesBeingHidden.indexOf(uuid);\n        this.filesBeingHidden.splice(i, 1);\n      }\n    }\n  }\n}\n","import app from 'flarum/common/app';\nimport File from '../models/File';\nimport AbstractFileList from './AbstractFIleList';\nimport FileListState from '../states/FileListState';\n\nexport default class UserFileList extends AbstractFileList {\n  public loadFileList(): void {\n    //app.fileListState.setUser(this.attrs.user || app.session.user);\n    this.fileState.setUser(this.attrs.user || app.session.user);\n    /**\n     * The user who's media we are dealing with\n     */\n    this.user = this.fileState.user; //app.fileListState.user;\n  }\n\n  hasMoreResults(): boolean {\n    return this.fileState.hasMoreResults();\n  }\n\n  loadMore(): void {\n    this.fileState.loadMore();\n  }\n\n  isLoading(): boolean {\n    return this.fileState.isLoading();\n  }\n\n  fileCollection(): File[] {\n    return this.fileState.files;\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Switch'];","import app from 'flarum/common/app';\nimport Modal, { IInternalModalAttrs } from 'flarum/common/components/Modal';\nimport Switch from 'flarum/common/components/Switch';\nimport mimeToIcon from '../mimeToIcon';\nimport Button from 'flarum/common/components/Button';\nimport type Mithril from 'mithril';\nimport { ApiResponsePlural } from 'flarum/common/Store';\nimport File from '../models/File';\n\ninterface CustomAttrs extends IInternalModalAttrs {\n  onUploadComplete: (files: File | File[]) => void;\n}\n\nexport default class UploadSharedFileModal extends Modal<CustomAttrs> {\n  files = [];\n  fileInput = null;\n  options = {\n    shared: true,\n    hidden: false,\n  };\n  loading: boolean = false;\n\n  oninit(vnode: Mithril.Vnode<CustomAttrs, this>) {\n    super.oninit(vnode);\n  }\n\n  className() {\n    return 'UploadSharedFileModal Modal--medium';\n  }\n\n  title() {\n    return app.translator.trans('fof-upload.lib.upload-shared-file-modal.title');\n  }\n\n  onFileChange(e) {\n    this.addFiles(Array.from(e.target.files));\n  }\n\n  addFiles(newFiles: File[]) {\n    (this.files as File[]).push(...newFiles);\n    m.redraw();\n  }\n\n  onDragOver(e) {\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  onDrop(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    if (e.dataTransfer && e.dataTransfer.files) {\n      this.addFiles(Array.from(e.dataTransfer.files));\n    }\n  }\n\n  onDropzoneClick() {\n    if (this.fileInput) {\n      this.fileInput.click();\n    }\n  }\n\n  content() {\n    return (\n      <div className=\"Modal-body\">\n        <div\n          className=\"UploadSharedFileModal-dropzone\"\n          onclick={() => this.onDropzoneClick()}\n          ondragover={this.onDragOver.bind(this)}\n          ondrop={this.onDrop.bind(this)}\n        >\n          {app.translator.trans('fof-upload.lib.upload-shared-file-modal.dropzone')}\n          <input\n            type=\"file\"\n            multiple\n            onchange={this.onFileChange.bind(this)}\n            style={{ opacity: 0, position: 'absolute', left: '-9999px' }}\n            oncreate={(vnode) => {\n              this.fileInput = vnode.dom;\n            }}\n          />\n        </div>\n        <div className=\"UploadSharedFileModal-files\">\n          {this.files.map((file: File) => {\n            const isImage = file.type.startsWith('image/');\n            return (\n              <div className=\"UploadedFile\">\n                {isImage ? <img src={URL.createObjectURL(file)} alt={file.name} /> : <i className={mimeToIcon(file.type)}></i>}\n                <div className=\"UploadedFile-name\">{file.name}</div>\n                {/* Remove button */}\n                <Button\n                  className=\"Button Button--icon Button--link UploadedFile-remove\"\n                  icon=\"fas fa-times\"\n                  onclick={() => {\n                    this.files = this.files.filter((f) => f !== file);\n                  }}\n                />\n              </div>\n            );\n          })}\n        </div>\n        <div className=\"UploadSharedFileModal-options Form-group\">\n          <Switch state={this.options.hidden} onchange={(value: boolean) => (this.options.hidden = value)}>\n            {app.translator.trans('fof-upload.lib.upload-shared-file-modal.hide-from-media-gallery')}\n          </Switch>\n        </div>\n        <div className=\"UploadSharedFileModal-submit App-primaryControl\">\n          <Button\n            className=\"Button Button--primary\"\n            loading={this.loading}\n            onclick={this.upload.bind(this)}\n            disabled={!this.files.length || this.loading}\n          >\n            {app.translator.trans('fof-upload.lib.upload-shared-file-modal.upload')}\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  async upload() {\n    this.loading = true;\n    m.redraw();\n\n    const formData = new FormData();\n\n    // Append each file to the form data\n    this.files.forEach((file) => {\n      formData.append('files[]', file);\n    });\n\n    Object.keys(this.options).forEach((key) => {\n      formData.append(`options[${key}]`, this.options[key]);\n    });\n\n    const results = await app.request<ApiResponsePlural<File>>({\n      method: 'POST',\n      url: app.forum.attribute('apiUrl') + '/fof/upload',\n      serialize: (raw: FormData) => raw, // Prevent mithril from trying to serialize FormData\n      body: formData,\n    });\n\n    const uploadedFiles = app.store.pushPayload(results);\n\n    this.attrs.onUploadComplete(uploadedFiles);\n    this.files = [];\n    this.hide();\n\n    this.loading = false;\n    m.redraw();\n  }\n}\n","import app from 'flarum/common/app';\nimport File from '../models/File';\nimport AbstractFileList from './AbstractFIleList';\n\nexport default class SharedFileList extends AbstractFileList {\n  public loadFileList(): void {\n    this.fileState.loadResults();\n  }\n\n  hasMoreResults() {\n    return this.fileState.hasMoreResults();\n  }\n\n  loadMore() {\n    this.fileState.loadMore();\n  }\n\n  isLoading(): boolean {\n    return this.fileState.isLoading();\n  }\n\n  fileCollection(): File[] {\n    return this.fileState.files;\n  }\n}\n","import app from 'flarum/common/app';\nimport User from 'flarum/common/models/User';\nimport File from '../models/File';\nimport { ApiQueryParamsPlural, ApiResponsePlural } from 'flarum/common/Store';\n\nexport default class FileListState {\n  public user: User | null;\n  public files: File[];\n  private moreResults: boolean;\n  private loading: boolean;\n  private sharedFiles: boolean;\n\n  constructor(sharedFiles: boolean = false) {\n    this.user = null;\n    this.files = [];\n    this.moreResults = false;\n    this.loading = false;\n    this.sharedFiles = sharedFiles;\n  }\n\n  /**\n   * Set the user and load their file list.\n   * @param user The user whose files to load.\n   */\n  public setUser(user: User): void {\n    if (user === this.user) return;\n\n    this.user = user;\n    this.files = [];\n    this.loadResults();\n  }\n\n  public refresh(): void {\n    this.files = [];\n    this.loadResults();\n    m.redraw();\n  }\n\n  /**\n   * Load more files for the current user, starting from the given offset.\n   * @param offset The starting index for loading more files.\n   * @returns A promise resolving to the loaded files.\n   */\n  public async loadResults(offset: number = 0): Promise<ApiResponsePlural<File>> {\n    if (!this.sharedFiles && !this.user) return Promise.reject('User not set');\n\n    this.loading = true;\n\n    let route: string = 'fof/uploads';\n    let params: ApiQueryParamsPlural = {};\n\n    if (!this.sharedFiles && this.user) {\n      params = {\n        filter: { user: this.user.id() },\n        page: { offset },\n      } as ApiQueryParamsPlural;\n    } else {\n      route = 'fof/upload/shared-files';\n      params = {\n        page: { offset },\n      } as ApiQueryParamsPlural;\n    }\n\n    const results = await app.store.find<File[]>(route, params);\n\n    return this.parseResults(results);\n  }\n\n  /**\n   * Load the next set of results.\n   */\n  public async loadMore(): Promise<ApiResponsePlural<File>> {\n    this.loading = true;\n    return this.loadResults(this.files.length);\n  }\n\n  private parseResults(results: ApiResponsePlural<File>): ApiResponsePlural<File> {\n    this.files = this.files.concat(results);\n    this.loading = false;\n    this.moreResults = !!results.payload?.links?.next;\n    m.redraw();\n    return results;\n  }\n\n  /**\n   * Add files to the beginning of the list.\n   * @param files The files to be added.\n   */\n  public addToList(files: File | File[]): void {\n    if (Array.isArray(files)) {\n      this.files.unshift(...files);\n    } else {\n      this.files.unshift(files);\n    }\n    m.redraw();\n  }\n\n  /**\n   * Remove files from the list.\n   * @param files The files to be removed.\n   */\n  public removeFromList(files: File | File[]): void {\n    if (Array.isArray(files)) {\n      this.files = this.files.filter((file) => !files.includes(file));\n    } else {\n      this.files = this.files.filter((file) => file !== files);\n    }\n\n    m.redraw();\n  }\n\n  /**\n   * Check if there are files in the list.\n   * @returns True if there are files, false otherwise.\n   */\n  public hasFiles(): boolean {\n    return this.files.length > 0;\n  }\n\n  /**\n   * Check if the file list is currently loading.\n   * @returns True if loading, false otherwise.\n   */\n  public isLoading(): boolean {\n    return this.loading;\n  }\n\n  /**\n   * Check if there are more files to load.\n   * @returns True if there are more files, false otherwise.\n   */\n  public hasMoreResults(): boolean {\n    return this.moreResults;\n  }\n\n  /**\n   * Check if the user has no files and the list is not loading.\n   * @returns True if the list is empty and not loading, false otherwise.\n   */\n  public empty(): boolean {\n    return !this.hasFiles() && !this.isLoading();\n  }\n}\n","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport Button from 'flarum/common/components/Button';\nimport UploadButton from './UploadButton';\nimport UserFileList from '../../common/components/UserFileList';\nimport DragAndDrop from './DragAndDrop';\nimport UploadSharedFileModal from '../../common/components/UploadSharedFileModal';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport SharedFileList from '../../common/components/SharedFileList';\nimport FileListState from '../../common/states/FileListState';\n\nexport default class FileManagerModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    // Initialize upload managers\n    this.uploader = vnode.attrs.uploader;\n\n    // Current selected files\n    this.selectedFiles = [];\n\n    // Allow multiselect\n    this.multiSelect = vnode.attrs.multiSelect === undefined ? true : vnode.attrs.multiSelect;\n\n    // Restrict file selection to specific types\n    this.restrictFileType = vnode.attrs.restrictFileType || null;\n\n    // Drag & drop\n    this.dragDrop = null;\n\n    this.selectedFilesLibrary = vnode.attrs.defaultFilesLibrary || 'user';\n\n    this.sharedUploads = null;\n\n    this.userFileState = new FileListState();\n    this.sharedFileState = new FileListState(true);\n\n    this.uploader.setState(this.userFileState);\n\n    // Initialize uploads\n    this.onUpload();\n  }\n\n  className() {\n    return 'Modal--large fof-file-manager-modal';\n  }\n\n  /**\n   * Initialize drag & drop\n   */\n  oncreate(vnode) {\n    super.oncreate(vnode);\n\n    this.dragDrop = new DragAndDrop((files) => this.uploader.upload(files, false), this.$().find('.Modal-content')[0]);\n  }\n\n  /**\n   * Remove events from modal content\n   */\n  onremove() {\n    if (this.dragDrop) {\n      this.dragDrop.unload();\n    }\n  }\n\n  view() {\n    const fileCount = this.selectedFiles.length;\n    const { hideUser, hideShared } = this.attrs;\n\n    return (\n      <div className={`Modal modal-dialog ${this.className()}`}>\n        <div className=\"Modal-content\">\n          <div className=\"fof-modal-buttons App-backControl\">\n            {!hideUser && this.selectedFilesLibrary === 'user' && (\n              <UploadButton uploader={this.uploader} disabled={this.userFileState.isLoading()} isMediaUploadButton />\n            )}\n            {app.session.user && app.session.user.uploadSharedFiles() && !hideShared && this.selectedFilesLibrary === 'shared' && (\n              <Button\n                className=\"Button\"\n                icon=\"fas fa-file-upload\"\n                onclick={() => {\n                  this.showUploadModal();\n                }}\n              >\n                {app.translator.trans('fof-upload.forum.buttons.upload')}\n              </Button>\n            )}\n          </div>\n\n          <div className=\"fof-drag-and-drop\">\n            <div className=\"fof-drag-and-drop-release\">\n              <i className=\"fas fa-cloud-upload-alt\" />\n\n              {app.translator.trans('fof-upload.lib.file_list.release_to_upload')}\n            </div>\n          </div>\n\n          <div className=\"Modal-header\">\n            <h3 className=\"App-titleControl App-titleControl--text\">{app.translator.trans('fof-upload.forum.media_manager')}</h3>\n            {app.session.user?.accessSharedFiles() && !hideUser && !hideShared && (\n              <div className=\"LibrarySelection\">{this.fileLibraryButtonItems().toArray()}</div>\n            )}\n          </div>\n\n          {this.alertAttrs && (\n            <div className=\"Modal-alert\">\n              <Alert {...this.alertAttrs} />\n            </div>\n          )}\n\n          <div className=\"Modal-body\">\n            {this.selectedFilesLibrary === 'user' && this.userFilesContent()}\n            {this.selectedFilesLibrary === 'shared' && this.sharedFilesContent()}\n          </div>\n\n          <div className=\"Modal-footer\">\n            <Button onclick={this.hide.bind(this)} className=\"Button\">\n              {app.translator.trans('fof-upload.forum.buttons.cancel')}\n            </Button>\n\n            <Button\n              onclick={this.onSelect.bind(this)}\n              disabled={this.selectedFiles.length === 0 || (!this.multiSelect && this.selectedFiles.length > 1)}\n              className=\"Button Button--primary\"\n            >\n              {app.translator.trans('fof-upload.lib.file_list.confirm_selection_btn', { fileCount })}\n            </Button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  fileLibraryButtonItems() {\n    const items = new ItemList();\n\n    items.add(\n      'user',\n      <Button className={`Button Button--flat ${this.selectedFilesLibrary === 'user' ? 'active' : ''}`} onclick={() => this.setLibrary('user')}>\n        {app.translator.trans('fof-upload.forum.buttons.media')}\n      </Button>\n    );\n\n    items.add(\n      'shared',\n      <Button className={`Button Button--flat ${this.selectedFilesLibrary === 'shared' ? 'active' : ''}`} onclick={() => this.setLibrary('shared')}>\n        {app.translator.trans('fof-upload.forum.buttons.shared_media')}\n      </Button>\n    );\n\n    return items;\n  }\n\n  setLibrary(library) {\n    this.selectedFilesLibrary = library;\n    m.redraw();\n  }\n\n  userFilesContent() {\n    return (\n      <UserFileList\n        user={this.attrs.user}\n        selectable\n        onFileSelect={this.onFileSelect.bind(this)}\n        selectedFiles={this.selectedFiles}\n        restrictFileType={this.restrictFileType}\n        fileState={this.userFileState}\n        onDelete={this.onDelete.bind(this)}\n      />\n    );\n  }\n\n  sharedFilesContent() {\n    return (\n      <SharedFileList\n        selectable\n        onFileSelect={this.onFileSelect.bind(this)}\n        selectedFiles={this.selectedFiles}\n        restrictFileType={this.restrictFileType}\n        user={this.attrs.user}\n        fileState={this.sharedFileState}\n        onDelete={this.onDelete.bind(this)}\n      />\n    );\n  }\n\n  /**\n   * Add or remove file from selected files\n   *\n   * @param {File} file\n   */\n  onFileSelect(file) {\n    const itemPosition = this.selectedFiles.indexOf(file.id());\n\n    if (itemPosition >= 0) {\n      this.selectedFiles.splice(itemPosition, 1);\n    } else {\n      if (this.multiSelect) {\n        this.selectedFiles.push(file.id());\n      } else {\n        this.selectedFiles = [file.id()];\n      }\n    }\n  }\n\n  /**\n   * Add files to file list after upload\n   */\n  onUpload() {\n    this.uploader.on('success', ({ file }) => {\n      if (this.multiSelect) {\n        this.selectedFiles.push(file.id());\n      } else {\n        this.selectedFiles = [file.id()];\n      }\n    });\n  }\n\n  /**\n   * Add selected files to the composer\n   */\n  onSelect() {\n    this.hide();\n\n    // Custom callback\n    if (this.attrs.onSelect) {\n      this.attrs.onSelect(this.selectedFiles);\n\n      return;\n    }\n\n    // Add selected files to composer\n    this.selectedFiles.map((fileId) => {\n      const file = app.store.getById('files', fileId) || app.store.getById('shared-files', fileId);\n\n      app.composer.editor.insertAtCursor(file.bbcode() + '\\n', false);\n    });\n  }\n\n  showUploadModal() {\n    app.modal.show(\n      UploadSharedFileModal,\n      {\n        onUploadComplete: (files) => {\n          this.sharedFileState.addToList(files);\n        },\n      },\n      true\n    );\n  }\n\n  onDelete(file) {\n    this.sharedFileState.removeFromList(file);\n    this.userFileState.removeFromList(file);\n  }\n}\n","import app from 'flarum/forum/app';\nimport Component, { ComponentAttrs } from 'flarum/common/Component';\nimport Button from 'flarum/common/components/Button';\nimport FileManagerModal from './FileManagerModal';\nimport Tooltip from 'flarum/common/components/Tooltip';\n\ninterface FileManagerButtonAttrs extends ComponentAttrs {\n  uploader: any;\n}\n\nexport default class FileManagerButton extends Component<FileManagerButtonAttrs> {\n  view() {\n    return (\n      <Tooltip text={app.translator.trans('fof-upload.forum.buttons.media')}>\n        {Button.component({\n          className: 'Button fof-upload-button Button--icon',\n          onclick: this.fileManagerButtonClicked.bind(this),\n          icon: 'fas fa-photo-video',\n        })}\n      </Tooltip>\n    );\n  }\n\n  /**\n   * Event handler for upload button being clicked\n   */\n  fileManagerButtonClicked(e: PointerEvent) {\n    e.preventDefault();\n\n    // Open dialog\n    app.modal.show(FileManagerModal, {\n      uploader: this.attrs.uploader,\n    });\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/UserPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LinkButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extenders'];","import Model from 'flarum/common/Model';\n\nexport default class File extends Model {\n  baseName() {\n    return Model.attribute<string>('baseName').call(this);\n  }\n\n  path() {\n    return Model.attribute<string>('path').call(this);\n  }\n\n  url() {\n    return Model.attribute<string>('url').call(this);\n  }\n\n  size() {\n    return Model.attribute<number>('size').call(this);\n  }\n\n  type() {\n    return Model.attribute<string>('type').call(this);\n  }\n\n  humanSize() {\n    return Model.attribute<string>('humanSize').call(this);\n  }\n\n  createdAt() {\n    return Model.attribute('createdAt', Model.transformDate).call(this);\n  }\n\n  uuid() {\n    return Model.attribute<string>('uuid').call(this);\n  }\n\n  tag() {\n    return Model.attribute<string>('tag').call(this);\n  }\n\n  hidden() {\n    return Model.attribute<boolean>('hidden').call(this);\n  }\n\n  bbcode() {\n    return Model.attribute<string>('bbcode').call(this);\n  }\n\n  isShared() {\n    return Model.attribute<boolean>('shared').call(this);\n  }\n\n  isPrivateShared() {\n    return Model.attribute<boolean>('isPrivateShared').call(this);\n  }\n\n  canViewInfo() {\n    return Model.attribute<boolean>('canViewInfo').call(this);\n  }\n\n  canHide() {\n    return Model.attribute<boolean>('canHide').call(this);\n  }\n\n  canDelete() {\n    return Model.attribute<boolean>('canDelete').call(this);\n  }\n\n  apiEndpoint() {\n    return '/fof/uploads' + (this.exists ? '/' + this.id() : '');\n  }\n}\n","import Extend from 'flarum/common/extenders';\nimport File from './models/File';\n\nexport default [\n  new Extend.Store() //\n    .add('files', File)\n    .add('shared-files', File),\n];\n","import app from 'flarum/forum/app';\nimport UserPage from 'flarum/forum/components/UserPage';\nimport UserFileList from '../../common/components/UserFileList';\nimport type Mithril from 'mithril';\nimport User from 'flarum/common/models/User';\nimport FileListState from '../../common/states/FileListState';\n\nimport type File from '../../common/models/File';\n\nexport default class UploadsUserPage extends UserPage {\n  fileState!: FileListState;\n\n  oninit(vnode: Mithril.Vnode<this>) {\n    super.oninit(vnode);\n\n    this.user = null;\n    this.fileState = new FileListState();\n\n    this.loadUser(m.route.param('username'));\n  }\n\n  content() {\n    if (app.session.user && (app.session.user.viewOthersMediaLibrary() || this.user === app.session.user)) {\n      return (\n        this.user &&\n        UserFileList.component({\n          user: this.user,\n          selectable: false,\n          downloadOnClick: true,\n          fileState: this.fileState,\n          onDelete: this.onDelete.bind(this),\n        })\n      );\n    } else {\n      return null;\n    }\n  }\n\n  onDelete(file: File) {\n    this.fileState.removeFromList(file);\n  }\n\n  show(user: User) {\n    super.show(user);\n    this.user = user;\n  }\n}\n","import User from 'flarum/common/models/User';\nimport { default as extend } from '../common/extend';\nimport Extend from 'flarum/common/extenders';\nimport UploadsUserPage from './components/UploadsUserPage';\n\nexport default [\n  ...extend,\n\n  // Not using the new extender yet, thinking about if to change the serialized names,\n  // or the js property names, as we can't change the key->attribute name via the extender,\n  // like we used to do with ie `User.prototype.viewOthersMediaLibrary = Model.attribute('fof-upload-viewOthersMediaLibrary');`\n  // new Extend.Model(User) //\n  //     .attribute<boolean>('fof-upload-viewOthersMediaLibrary')\n  //     .attribute<boolean>('fof-upload-deleteOthersMediaLibrary')\n  //     .attribute<number>('fof-upload-uploadCountCurrent')\n  //     .attribute<number>('fof-upload-uploadCountAll'),\n\n  new Extend.Routes() //\n    .add('user.uploads', '/u/:username/uploads', UploadsUserPage),\n];\n","function _extends() {\n  return _extends = Object.assign ? Object.assign.bind() : function (n) {\n    for (var e = 1; e < arguments.length; e++) {\n      var t = arguments[e];\n      for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]);\n    }\n    return n;\n  }, _extends.apply(null, arguments);\n}\nexport { _extends as default };","import Component, { ComponentAttrs } from 'flarum/common/Component';\nimport Button from 'flarum/common/components/Button';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport type Mithril from 'mithril';\nimport mimeToIcon from '../mimeToIcon';\nimport File from '../models/File';\nimport icon from 'flarum/common/helpers/icon';\nimport app from 'flarum/common/app';\nimport classList from 'flarum/common/utils/classList';\n\ninterface CustomAttrs extends ComponentAttrs {\n  file: File;\n  selectable: boolean;\n  fileClassNames: string;\n  onDelete: (file: File) => void | undefined;\n  onFileSelect: (file: File) => void | undefined;\n}\n\nexport default class UploadedFile extends Component<CustomAttrs> {\n  file!: File;\n  callback!: () => void | undefined;\n  imageLoaded: boolean = true;\n\n  oninit(vnode: Mithril.Vnode<CustomAttrs, this>) {\n    super.oninit(vnode);\n\n    this.file = this.attrs.file;\n  }\n\n  view() {\n    const isImage = this.file.type().startsWith('image/');\n    const fileIcon = mimeToIcon(this.file.type());\n    const errorIcon = 'fas fa-exclamation-triangle';\n    const statusIcon = this.file.isPrivateShared() ? 'fas fa-lock' : 'fas fa-unlock';\n\n    return (\n      <div className=\"UploadedFile\" key={this.file.uuid()}>\n        <div className=\"UploadedFile--sharestatus\">\n          <span>\n            {icon(statusIcon)}\n            {this.file.baseName()}\n          </span>\n        </div>\n        <div className=\"UploadedFile--preview\" onclick={() => this.onFileClick(this.file)}>\n          {isImage ? (\n            this.imageLoaded ? (\n              <img\n                className={this.attrs.fileClassNames}\n                src={this.file.url()}\n                loading=\"lazy\"\n                onerror={this.handleImageError}\n                onload={this.handleImageLoad}\n                alt={this.file.baseName()}\n              />\n            ) : (\n              icon(errorIcon, { className: 'icon-fallback' }) // Error icon for failed image load\n            )\n          ) : (\n            icon(fileIcon, { className: 'icon-fallback' }) // Icon representing the file type\n          )}\n        </div>\n        <div className=\"UploadedFile--actions\">{this.actionItems().toArray()}</div>\n      </div>\n    );\n  }\n\n  actionItems(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    items.add(\n      'view-info',\n      <Button className=\"Button Button--icon\" icon=\"fas fa-info-circle\" onclick={() => this.viewFileInfo()} aria-label=\"info\" />\n    );\n\n    items.add(\n      'download',\n      <Button className=\"Button Button--icon\" icon=\"fas fa-download\" onclick={() => window.open(this.file.url())} aria-label=\"download\" />\n    );\n\n    const hideFileIcon = this.file.isPrivateShared() ? 'fas fa-lock' : this.file.hidden() ? 'fas fa-eye' : 'fas fa-eye-slash';\n    items.add('hide-file', <Button className=\"Button Button--icon\" icon={hideFileIcon} onclick={() => this.hideFile()} aria-label=\"hide\" />);\n\n    items.add('delete', <Button className=\"Button Button--icon\" icon=\"fas fa-trash\" onclick={() => this.confirmDelete()} aria-label=\"delete\" />);\n\n    return items;\n  }\n\n  async confirmDelete() {\n    let result = confirm('Are you sure you want to delete this file?');\n\n    if (result) {\n      const uuid = this.file.uuid();\n      await app.request({\n        method: 'DELETE',\n        url: app.forum.attribute('apiUrl') + '/fof/upload/delete/' + uuid,\n      });\n\n      if (this.attrs.onDelete) {\n        this.attrs.onDelete(this.file);\n      }\n    }\n  }\n\n  viewFileInfo() {\n    // TODO:\n    console.log('view file info');\n  }\n\n  hideFile() {\n    // TODO:\n    console.log('hide file');\n  }\n\n  // Function to call when image fails to load\n  handleImageError = () => {\n    this.imageLoaded = false;\n    m.redraw();\n  };\n\n  // Function to call when image loads successfully\n  handleImageLoad = () => {\n    this.imageLoaded = true;\n    m.redraw();\n  };\n\n  onFileClick(file: File) {\n    if (this.attrs.onFileSelect) {\n      this.attrs.onFileSelect(file);\n      return;\n    }\n  }\n}\n","import Uploader from '../handler/Uploader';\nimport DragAndDrop from './DragAndDrop';\nimport FileManagerButton from './FileManagerButton';\nimport FileManagerModal from './FileManagerModal';\nimport UploadButton from './UploadButton';\nimport { commonComponents } from '../../common/components';\n\nexport const components = {\n  ...commonComponents,\n  DragAndDrop,\n  FileManagerButton,\n  FileManagerModal,\n  Uploader,\n  UploadButton,\n};\n","import UploadSharedFileModal from './UploadSharedFileModal';\nimport UploadedFile from './UploadedFile';\nimport UserFileList from './UserFileList';\n\nexport const commonComponents = {\n  UploadedFile,\n  UploadSharedFileModal,\n  UserFileList,\n};\n","import app from 'flarum/forum/app';\nimport User from 'flarum/common/models/User';\nimport Model from 'flarum/common/Model';\nimport downloadButtonInteraction from './downloadButtonInteraction';\nimport addUploadButton from './addUploadButton';\nimport addUserPageButton from './addUserPageButton';\n\nexport { default as extend } from './extend';\nexport * from './components';\n\napp.initializers.add('fof-upload', () => {\n  // Leaving these here for now.\n  // @see ./extend.ts\n  User.prototype.viewOthersMediaLibrary = Model.attribute('fof-upload-viewOthersMediaLibrary');\n  User.prototype.deleteOthersMediaLibrary = Model.attribute('fof-upload-deleteOthersMediaLibrary');\n  User.prototype.uploadCountCurrent = Model.attribute('fof-upload-uploadCountCurrent');\n  User.prototype.uploadCountAll = Model.attribute('fof-upload-uploadCountAll');\n  User.prototype.uploadSharedFiles = Model.attribute('fof-upload-uploadSharedFiles');\n  User.prototype.accessSharedFiles = Model.attribute('fof-upload-accessSharedFiles');\n\n  //app.fileListState = new FileListState();\n\n  addUploadButton();\n  downloadButtonInteraction();\n  addUserPageButton();\n});\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport TextEditor from 'flarum/common/components/TextEditor';\nimport UploadButton from './components/UploadButton';\nimport DragAndDrop from './components/DragAndDrop';\nimport PasteClipboard from './components/PasteClipboard';\nimport Uploader from './handler/Uploader';\nimport FileManagerButton from './components/FileManagerButton';\n\nexport default function () {\n  extend(TextEditor.prototype, 'oninit', function () {\n    this.uploader = new Uploader();\n  });\n  extend(TextEditor.prototype, 'controlItems', function (items) {\n    if (!app.forum.attribute('fof-upload.canUpload')) return;\n\n    const composerButtonVisiblity = app.forum.attribute('fof-upload.composerButtonVisiblity');\n\n    // Add media button\n    if (composerButtonVisiblity === 'both' || composerButtonVisiblity === 'media-btn') {\n      items.add(\n        'fof-upload-media',\n        FileManagerButton.component({\n          uploader: this.uploader,\n        })\n      );\n    }\n\n    // Add upload button\n    if (composerButtonVisiblity === 'both' || composerButtonVisiblity === 'upload-btn') {\n      items.add(\n        'fof-upload',\n        UploadButton.component({\n          uploader: this.uploader,\n        })\n      );\n    }\n  });\n\n  extend(TextEditor.prototype, 'oncreate', function (f_, vnode) {\n    if (!app.forum.attribute('fof-upload.canUpload')) return;\n\n    this.uploader.on('success', ({ file, addBBcode }) => {\n      if (!addBBcode) return;\n\n      this.attrs.composer.editor.insertAtCursor(file.bbcode() + '\\n', false);\n\n      // We wrap this in a typeof check to prevent it running when a user\n      // is creating a new discussion. There's nothing to preview in a new\n      // discussion, so the `preview` function isn't defined.\n      if (typeof this.attrs.preview === 'function') {\n        // Scroll the preview into view\n        // preview() causes the composer to close on mobile, but we don't want that. We want only the scroll\n        // We work around that by temporarily patching the isFullScreen method\n        const originalIsFullScreen = app.composer.isFullScreen;\n\n        app.composer.isFullScreen = () => false;\n\n        this.attrs.preview();\n\n        app.composer.isFullScreen = originalIsFullScreen;\n      }\n    });\n\n    // Gracefully fail if the TextEditor was used in a non-Composer context\n    // Using a custom method to retrieve the target allows other extensions to still use this feature by returning an alternate container\n    const dragAndDropTarget = this.fofUploadDragAndDropTarget();\n\n    if (dragAndDropTarget) {\n      this.dragAndDrop = new DragAndDrop((files) => this.uploader.upload(files), dragAndDropTarget);\n    }\n\n    new PasteClipboard((files) => this.uploader.upload(files), this.$('.TextEditor-editor')[0]);\n  });\n\n  extend(TextEditor.prototype, 'onremove', function (f_, vnode) {\n    if (!app.forum.attribute('fof-upload.canUpload')) return;\n\n    if (this.dragAndDrop) {\n      this.dragAndDrop.unload();\n    }\n  });\n\n  TextEditor.prototype.fofUploadDragAndDropTarget = function () {\n    return this.$().parents('.Composer')[0];\n  };\n}\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport Post from 'flarum/forum/components/Post';\n\n/* global $ */\n\nexport default function () {\n  extend(Post.prototype, 'oncreate', function () {\n    this.$('[data-fof-upload-download-uuid]')\n      .unbind('click')\n      .on('click', (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n\n        if (!app.forum.attribute('fof-upload.canDownload')) {\n          alert(app.translator.trans('fof-upload.forum.states.unauthorized'));\n          return;\n        }\n\n        let url = app.forum.attribute('apiUrl') + '/fof/download';\n\n        url += '/' + encodeURIComponent(e.currentTarget.dataset.fofUploadDownloadUuid);\n        url += '/' + encodeURIComponent(this.attrs.post.id());\n        url += '/' + encodeURIComponent(app.session.csrfToken);\n\n        window.open(url);\n      });\n  });\n}\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport UserPage from 'flarum/forum/components/UserPage';\nimport LinkButton from 'flarum/common/components/LinkButton';\n\nexport default function addUserPageButton() {\n  extend(UserPage.prototype, 'navItems', function (items) {\n    const canUpload = !!app.forum.attribute('fof-upload.canUpload');\n    const hasUploads = !!this.user.uploadCountCurrent();\n\n    if (app.session.user && (app.session.user.viewOthersMediaLibrary() || (this.user === app.session.user && (canUpload || hasUploads)))) {\n      const uploadCount = this.user.uploadCountCurrent();\n\n      items.add(\n        'uploads',\n        LinkButton.component(\n          {\n            href: app.route('user.uploads', {\n              username: this.user.slug(),\n            }),\n            name: 'uploads',\n            icon: 'fas fa-file-upload',\n          },\n          [\n            this.user === app.session.user\n              ? app.translator.trans('fof-upload.forum.buttons.media')\n              : app.translator.trans('fof-upload.forum.buttons.user_uploads'),\n            ' ',\n            uploadCount > 0 ? <span className=\"Button-badge\">{uploadCount}</span> : '',\n          ]\n        ),\n        80\n      );\n    }\n  });\n}\n"],"names":["_typeof","require","_regeneratorRuntime","module","exports","e","__esModule","t","r","Object","prototype","n","hasOwnProperty","o","defineProperty","value","i","Symbol","a","iterator","c","asyncIterator","u","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","call","h","l","f","s","y","GeneratorFunction","GeneratorFunctionPrototype","p","this","d","getPrototypeOf","v","values","g","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","resolve","__await","then","callInvokeWithMethodAndArg","Error","done","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","isNaN","length","displayName","isGeneratorFunction","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","reverse","pop","prev","charAt","slice","stop","rval","handle","complete","finish","delegateYield","runtime","regeneratorRuntime","accidentalStrictMode","globalThis","Function","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","getter","definition","key","get","obj","prop","flarum","core","compat","_setPrototypeOf","bind","_inheritsLoose","UploadButton","_Component","apply","arguments","_proto","oninit","vnode","_this","attrs","uploader","on","$","m","redraw","isMediaUploadButton","view","buttonText","uploading","app","trans","Button","className","classList","icon","onclick","uploadButtonClicked","disabled","LoadingIndicator","size","display","multiple","onchange","process","files","upload","click","Component","DragAndDrop","composerElement","handlers","supportsFileDragging","addEventListener","out","dropping","div","document","createElement","window","unload","removeEventListener","isNotFile","event","dataTransfer","items","kind","preventDefault","over","add","remove","PasteClipboard","element","paste","clipboardData","indexOf","getAsFile","Uploader","callbacks","success","failure","uploaded","setState","fileState","callback","dispatch","response","addBBcode","body","FormData","append","url","attribute","serialize","raw","result","error","errors","code","includes","clear","show","detail","_this2","data","file","_this2$fileState","fileObj","pushObject","addToList","asyncGeneratorStep","_asyncToGenerator","_next","_throw","mimeToIconMap","Map","mimeToIcon","fileType","startsWith","DisplayFile","_len","args","Array","_key","concat","isFileHiding","imageLoaded","fileIcon","isSelected","isSelectable","handleImageError","handleImageLoad","fileSelectable","onbeforeupdate","isImage","fileSelectedClass","uuid","onFileClick","src","draggable","onerror","onload","alt","baseName","displayIcon","actionItems","toArray","Tooltip","text","class","role","style","alignItems","justifyContent","height","_this3","ItemList","canViewInfo","viewFileInfo","transPrefix","isShared","hideTranslation","hidden","fileName","canHide","position","hide","deleteTranslation","canDelete","confirmDelete","console","log","stopPropagation","onHide","_confirmDelete","_callee","_context","confirm","extractText","onDelete","_x","AbstractFileList","user","inModal","restrictFileType","downloadOnClick","filesBeingHidden","selectable","loadFileList","isLoading","fileCollection","map","_file$id","_file$id2","fileClassNames","selectedFiles","id","hideFile","hasMoreResults","loading","loadMore","onFileSelect","open","isArray","_hideFile","filePayload","index","pushPayload","Alert","findIndex","splice","t0","UserFileList","_AbstractFileList","setUser","UploadSharedFileModal","_Modal","fileInput","options","shared","title","onFileChange","addFiles","from","target","newFiles","_ref","onDragOver","onDrop","onDropzoneClick","content","ondragover","ondrop","opacity","left","oncreate","dom","URL","createObjectURL","filter","Switch","state","_upload","formData","results","uploadedFiles","onUploadComplete","Modal","SharedFileList","loadResults","FileListState","sharedFiles","moreResults","refresh","_loadResults","offset","route","params","reject","page","find","parseResults","_loadMore","_callee2","_context2","_results$payload","payload","links","_this$files","unshift","removeFromList","hasFiles","empty","FileManagerModal","multiSelect","dragDrop","selectedFilesLibrary","defaultFilesLibrary","sharedUploads","userFileState","sharedFileState","onUpload","onremove","_app$session$user","fileCount","_this$attrs","hideUser","hideShared","uploadSharedFiles","showUploadModal","accessSharedFiles","fileLibraryButtonItems","alertAttrs","userFilesContent","sharedFilesContent","onSelect","setLibrary","library","itemPosition","_this4","fileId","getById","editor","insertAtCursor","bbcode","_this5","FileManagerButton","fileManagerButtonClicked","File","_Model","Model","path","humanSize","createdAt","tag","isPrivateShared","apiEndpoint","exists","Extend","UploadsUserPage","_UserPage","loadUser","param","viewOthersMediaLibrary","component","UserPage","extend","_extends","assign","components","UploadedFile","statusIcon","hideFileIcon","User","deleteOthersMediaLibrary","uploadCountCurrent","uploadCountAll","TextEditor","composerButtonVisiblity","f_","composer","preview","originalIsFullScreen","isFullScreen","dragAndDropTarget","fofUploadDragAndDropTarget","dragAndDrop","parents","Post","unbind","encodeURIComponent","currentTarget","dataset","fofUploadDownloadUuid","post","csrfToken","alert","canUpload","hasUploads","uploadCount","LinkButton","href","username","slug"],"sourceRoot":""}